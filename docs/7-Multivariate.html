<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.475">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Introduction to Data Science with R - 7&nbsp; Multivariate Statistics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./8-MachineLearning.html" rel="next">
<link href="./6-GLM.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<meta name="citation_title" content="[7]{.chapter-number}&nbsp; [Multivariate Statistics]{.chapter-title}">
<meta name="citation_fulltext_html_url" content="https://TheoreticalEcology.github.io/DataScienceInR//7-Multivariate.html">
<meta name="citation_language" content="en">
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">
<span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Multivariate Statistics</span>
</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Introduction to Data Science with R</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/TheoreticalEcology/DataScienceInR" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
    <a href="" title="Share" id="sidebar-tool-dropdown-0" class="sidebar-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi bi-share"></i></a>
    <ul class="dropdown-menu" aria-labelledby="sidebar-tool-dropdown-0">
<li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=%7Curl%7C">
            <i class="bi bi-bi-twitter pe-1"></i>
          Twitter
          </a>
        </li>
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=%7Curl%7C">
            <i class="bi bi-bi-facebook pe-1"></i>
          Facebook
          </a>
        </li>
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=%7Curl%7C">
            <i class="bi bi-bi-linkedin pe-1"></i>
          LinkedIn
          </a>
        </li>
    </ul>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1-GettingStarted.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Getting Started with R</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2-DescriptiveStatistics.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Plotting and describing data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3-HypothesisTesting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Hypothesis Tests</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./4-SimpleRegression.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Simple linear regression</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./5-MultipleRegression.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Multiple regression</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./6-GLM.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Generalized linear models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./7-Multivariate.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Multivariate Statistics</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./8-MachineLearning.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Machine Learning</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./9-DataScienceSkills.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Data handling</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-Outlook.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Outlook</span></a>
  </div>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#classroom-demo" id="toc-classroom-demo" class="nav-link active" data-scroll-target="#classroom-demo"><span class="toc-section-number">7.1</span>  Classroom demo</a></li>
  <li>
<a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="toc-section-number">7.2</span>  Exercises</a>
  <ul class="collapse">
<li><a href="#unconstrained-ordination-pca" id="toc-unconstrained-ordination-pca" class="nav-link" data-scroll-target="#unconstrained-ordination-pca"><span class="toc-section-number">7.2.1</span>  Unconstrained ordination (PCA)</a></li>
  <li><a href="#clustering" id="toc-clustering" class="nav-link" data-scroll-target="#clustering"><span class="toc-section-number">7.2.2</span>  Clustering</a></li>
  </ul>
</li>
  </ul><div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/TheoreticalEcology/DataScienceInR/edit/master/7-Multivariate.qmd" class="toc-action">Edit this page</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title d-none d-lg-block">
<span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Multivariate Statistics</span>
</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><section id="classroom-demo" class="level2" data-number="7.1"><h2 data-number="7.1" class="anchored" data-anchor-id="classroom-demo">
<span class="header-section-number">7.1</span> Classroom demo</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># Part 3</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="co"># Multivariate statistics</span></span>
<span id="cb1-3"><a href="#cb1-3"></a></span>
<span id="cb1-4"><a href="#cb1-4"></a></span>
<span id="cb1-5"><a href="#cb1-5"></a></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="co"># Method 1: unconstrained ------------------------------------------------</span></span>
<span id="cb1-7"><a href="#cb1-7"></a></span>
<span id="cb1-8"><a href="#cb1-8"></a></span>
<span id="cb1-9"><a href="#cb1-9"></a></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="do">## PCA</span></span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="co"># we use the same dataset of flower characteristics of three species of iris</span></span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="fu">pairs</span>(iris, <span class="at">col =</span> iris<span class="sc">$</span>Species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="7-Multivariate_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="fu">head</span>(iris)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sepal.Length Sepal.Width Petal.Length Petal.Width Species
1          5.1         3.5          1.4         0.2  setosa
2          4.9         3.0          1.4         0.2  setosa
3          4.7         3.2          1.3         0.2  setosa
4          4.6         3.1          1.5         0.2  setosa
5          5.0         3.6          1.4         0.2  setosa
6          5.4         3.9          1.7         0.4  setosa</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>pca <span class="ot">=</span> <span class="fu">prcomp</span>(iris[, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="at">scale =</span> T) <span class="co"># always set scale = T</span></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="co"># when data is very skewed --&gt; better transform e.g. log</span></span>
<span id="cb4-3"><a href="#cb4-3"></a></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="fu">summary</span>(pca)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Importance of components:
                          PC1    PC2     PC3     PC4
Standard deviation     1.7084 0.9560 0.38309 0.14393
Proportion of Variance 0.7296 0.2285 0.03669 0.00518
Cumulative Proportion  0.7296 0.9581 0.99482 1.00000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="co"># standard deviation^2 is variance!!!</span></span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="co"># cum prop of PC2 is the variance that is visualized in a biplot</span></span>
<span id="cb6-3"><a href="#cb6-3"></a></span>
<span id="cb6-4"><a href="#cb6-4"></a></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="co"># plot the result</span></span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="co"># absolute variance of each component</span></span>
<span id="cb6-7"><a href="#cb6-7"></a><span class="fu">plot</span>(pca) <span class="co"># see row1 of the summary(pca): (sd)^2 = variance</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="7-Multivariate_files/figure-html/unnamed-chunk-2-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># rel variance of each component</span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="fu">barplot</span>(<span class="fu">summary</span>(pca)<span class="sc">$</span>importance[<span class="dv">2</span>, ], </span>
<span id="cb7-3"><a href="#cb7-3"></a>        <span class="at">ylab=</span><span class="st">"proportion of variance explained"</span>) <span class="co"># displays % of variance explained by PCs</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="7-Multivariate_files/figure-html/unnamed-chunk-2-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="co"># Biplot</span></span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="fu">biplot</span>(pca) <span class="co"># displays PC1 and PC2 AND rotation (vectors) of the different variables AND observations</span></span>
<span id="cb8-3"><a href="#cb8-3"></a></span>
<span id="cb8-4"><a href="#cb8-4"></a></span>
<span id="cb8-5"><a href="#cb8-5"></a></span>
<span id="cb8-6"><a href="#cb8-6"></a></span>
<span id="cb8-7"><a href="#cb8-7"></a><span class="do">## distance-based approach: NMDS</span></span>
<span id="cb8-8"><a href="#cb8-8"></a></span>
<span id="cb8-9"><a href="#cb8-9"></a><span class="fu">library</span>(vegan)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: permute</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: lattice</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>This is vegan 2.6-4</code></pre>
</div>
<div class="cell-output-display">
<p><img src="7-Multivariate_files/figure-html/unnamed-chunk-2-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>?vegan</span>
<span id="cb12-2"><a href="#cb12-2"></a></span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="co"># community dataset for plants in dunes (included in vegan package):</span></span>
<span id="cb12-4"><a href="#cb12-4"></a></span>
<span id="cb12-5"><a href="#cb12-5"></a><span class="fu">data</span>(<span class="st">"dune"</span>)</span>
<span id="cb12-6"><a href="#cb12-6"></a><span class="fu">str</span>(dune) <span class="co"># display structure of the dataset</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   20 obs. of  30 variables:
 $ Achimill: num  1 3 0 0 2 2 2 0 0 4 ...
 $ Agrostol: num  0 0 4 8 0 0 0 4 3 0 ...
 $ Airaprae: num  0 0 0 0 0 0 0 0 0 0 ...
 $ Alopgeni: num  0 2 7 2 0 0 0 5 3 0 ...
 $ Anthodor: num  0 0 0 0 4 3 2 0 0 4 ...
 $ Bellpere: num  0 3 2 2 2 0 0 0 0 2 ...
 $ Bromhord: num  0 4 0 3 2 0 2 0 0 4 ...
 $ Chenalbu: num  0 0 0 0 0 0 0 0 0 0 ...
 $ Cirsarve: num  0 0 0 2 0 0 0 0 0 0 ...
 $ Comapalu: num  0 0 0 0 0 0 0 0 0 0 ...
 $ Eleopalu: num  0 0 0 0 0 0 0 4 0 0 ...
 $ Elymrepe: num  4 4 4 4 4 0 0 0 6 0 ...
 $ Empenigr: num  0 0 0 0 0 0 0 0 0 0 ...
 $ Hyporadi: num  0 0 0 0 0 0 0 0 0 0 ...
 $ Juncarti: num  0 0 0 0 0 0 0 4 4 0 ...
 $ Juncbufo: num  0 0 0 0 0 0 2 0 4 0 ...
 $ Lolipere: num  7 5 6 5 2 6 6 4 2 6 ...
 $ Planlanc: num  0 0 0 0 5 5 5 0 0 3 ...
 $ Poaprat : num  4 4 5 4 2 3 4 4 4 4 ...
 $ Poatriv : num  2 7 6 5 6 4 5 4 5 4 ...
 $ Ranuflam: num  0 0 0 0 0 0 0 2 0 0 ...
 $ Rumeacet: num  0 0 0 0 5 6 3 0 2 0 ...
 $ Sagiproc: num  0 0 0 5 0 0 0 2 2 0 ...
 $ Salirepe: num  0 0 0 0 0 0 0 0 0 0 ...
 $ Scorautu: num  0 5 2 2 3 3 3 3 2 3 ...
 $ Trifprat: num  0 0 0 0 2 5 2 0 0 0 ...
 $ Trifrepe: num  0 5 2 1 2 5 2 2 3 6 ...
 $ Vicilath: num  0 0 0 0 0 0 0 0 0 1 ...
 $ Bracruta: num  0 0 2 2 2 6 2 2 2 2 ...
 $ Callcusp: num  0 0 0 0 0 0 0 0 0 0 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>?dune</span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="fu">summary</span>(dune) <span class="co"># display summary of the dataset (summary statistics for each variable)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Achimill      Agrostol      Airaprae       Alopgeni       Anthodor   
 Min.   :0.0   Min.   :0.0   Min.   :0.00   Min.   :0.00   Min.   :0.00  
 1st Qu.:0.0   1st Qu.:0.0   1st Qu.:0.00   1st Qu.:0.00   1st Qu.:0.00  
 Median :0.0   Median :1.5   Median :0.00   Median :0.00   Median :0.00  
 Mean   :0.8   Mean   :2.4   Mean   :0.25   Mean   :1.80   Mean   :1.05  
 3rd Qu.:2.0   3rd Qu.:4.0   3rd Qu.:0.00   3rd Qu.:3.25   3rd Qu.:2.25  
 Max.   :4.0   Max.   :8.0   Max.   :3.00   Max.   :8.00   Max.   :4.00  
    Bellpere       Bromhord       Chenalbu       Cirsarve      Comapalu  
 Min.   :0.00   Min.   :0.00   Min.   :0.00   Min.   :0.0   Min.   :0.0  
 1st Qu.:0.00   1st Qu.:0.00   1st Qu.:0.00   1st Qu.:0.0   1st Qu.:0.0  
 Median :0.00   Median :0.00   Median :0.00   Median :0.0   Median :0.0  
 Mean   :0.65   Mean   :0.75   Mean   :0.05   Mean   :0.1   Mean   :0.2  
 3rd Qu.:2.00   3rd Qu.:0.50   3rd Qu.:0.00   3rd Qu.:0.0   3rd Qu.:0.0  
 Max.   :3.00   Max.   :4.00   Max.   :1.00   Max.   :2.0   Max.   :2.0  
    Eleopalu       Elymrepe      Empenigr      Hyporadi       Juncarti   
 Min.   :0.00   Min.   :0.0   Min.   :0.0   Min.   :0.00   Min.   :0.00  
 1st Qu.:0.00   1st Qu.:0.0   1st Qu.:0.0   1st Qu.:0.00   1st Qu.:0.00  
 Median :0.00   Median :0.0   Median :0.0   Median :0.00   Median :0.00  
 Mean   :1.25   Mean   :1.3   Mean   :0.1   Mean   :0.45   Mean   :0.90  
 3rd Qu.:1.00   3rd Qu.:4.0   3rd Qu.:0.0   3rd Qu.:0.00   3rd Qu.:0.75  
 Max.   :8.00   Max.   :6.0   Max.   :2.0   Max.   :5.00   Max.   :4.00  
    Juncbufo       Lolipere      Planlanc      Poaprat       Poatriv    
 Min.   :0.00   Min.   :0.0   Min.   :0.0   Min.   :0.0   Min.   :0.00  
 1st Qu.:0.00   1st Qu.:0.0   1st Qu.:0.0   1st Qu.:0.0   1st Qu.:0.00  
 Median :0.00   Median :2.0   Median :0.0   Median :3.0   Median :4.00  
 Mean   :0.65   Mean   :2.9   Mean   :1.3   Mean   :2.4   Mean   :3.15  
 3rd Qu.:0.00   3rd Qu.:6.0   3rd Qu.:3.0   3rd Qu.:4.0   3rd Qu.:5.00  
 Max.   :4.00   Max.   :7.0   Max.   :5.0   Max.   :5.0   Max.   :9.00  
    Ranuflam      Rumeacet      Sagiproc    Salirepe       Scorautu  
 Min.   :0.0   Min.   :0.0   Min.   :0   Min.   :0.00   Min.   :0.0  
 1st Qu.:0.0   1st Qu.:0.0   1st Qu.:0   1st Qu.:0.00   1st Qu.:2.0  
 Median :0.0   Median :0.0   Median :0   Median :0.00   Median :2.0  
 Mean   :0.7   Mean   :0.9   Mean   :1   Mean   :0.55   Mean   :2.7  
 3rd Qu.:2.0   3rd Qu.:0.5   3rd Qu.:2   3rd Qu.:0.00   3rd Qu.:3.0  
 Max.   :4.0   Max.   :6.0   Max.   :5   Max.   :5.00   Max.   :6.0  
    Trifprat       Trifrepe       Vicilath      Bracruta       Callcusp  
 Min.   :0.00   Min.   :0.00   Min.   :0.0   Min.   :0.00   Min.   :0.0  
 1st Qu.:0.00   1st Qu.:1.00   1st Qu.:0.0   1st Qu.:1.50   1st Qu.:0.0  
 Median :0.00   Median :2.00   Median :0.0   Median :2.00   Median :0.0  
 Mean   :0.45   Mean   :2.35   Mean   :0.2   Mean   :2.45   Mean   :0.5  
 3rd Qu.:0.00   3rd Qu.:3.00   3rd Qu.:0.0   3rd Qu.:4.00   3rd Qu.:0.0  
 Max.   :5.00   Max.   :6.00   Max.   :2.0   Max.   :6.00   Max.   :4.0  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>NMDS <span class="ot">=</span> <span class="fu">metaMDS</span>(dune)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Run 0 stress 0.1192678 
Run 1 stress 0.1886532 
Run 2 stress 0.1192678 
... Procrustes: rmse 1.258026e-05  max resid 3.164268e-05 
... Similar to previous best
Run 3 stress 0.1183186 
... New best solution
... Procrustes: rmse 0.02027014  max resid 0.06496123 
Run 4 stress 0.1183186 
... Procrustes: rmse 4.230386e-06  max resid 1.475206e-05 
... Similar to previous best
Run 5 stress 0.1192678 
Run 6 stress 0.1809578 
Run 7 stress 0.1889638 
Run 8 stress 0.1808911 
Run 9 stress 0.3680059 
Run 10 stress 0.1183186 
... Procrustes: rmse 1.16265e-05  max resid 3.451986e-05 
... Similar to previous best
Run 11 stress 0.1183186 
... Procrustes: rmse 4.643335e-06  max resid 1.388314e-05 
... Similar to previous best
Run 12 stress 0.2361935 
Run 13 stress 0.1192679 
Run 14 stress 0.1192679 
Run 15 stress 0.1183186 
... Procrustes: rmse 1.447333e-05  max resid 4.510486e-05 
... Similar to previous best
Run 16 stress 0.1192679 
Run 17 stress 0.1192678 
Run 18 stress 0.1192679 
Run 19 stress 0.1808911 
Run 20 stress 0.1808911 
*** Best solution repeated 4 times</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="co"># algorithm is iterative</span></span>
<span id="cb18-2"><a href="#cb18-2"></a></span>
<span id="cb18-3"><a href="#cb18-3"></a>NMDS <span class="co"># gives information on NMDS: distance measure, stress (should be low)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
metaMDS(comm = dune) 

global Multidimensional Scaling using monoMDS

Data:     dune 
Distance: bray 

Dimensions: 2 
Stress:     0.1183186 
Stress type 1, weak ties
Best solution was repeated 4 times in 20 tries
The best solution was from try 3 (random start)
Scaling: centring, PC rotation, halfchange scaling 
Species: expanded scores based on 'dune' </code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="co"># stress of &gt;= 0.2 = be suspicious, stress &gt;=0.3 indicates that ordination is arbitrary</span></span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="co"># in crease Dimensions if k is too high</span></span>
<span id="cb20-3"><a href="#cb20-3"></a><span class="fu">ordiplot</span>(NMDS, <span class="at">type =</span> <span class="st">"t"</span>) <span class="co">#"t" = text</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="7-Multivariate_files/figure-html/unnamed-chunk-2-5.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="co"># if we have time:</span></span>
<span id="cb21-2"><a href="#cb21-2"></a><span class="co"># distance measure can be changed (default is Bray-Curtis): see </span></span>
<span id="cb21-3"><a href="#cb21-3"></a>?vegdist <span class="co"># some recommendations there</span></span>
<span id="cb21-4"><a href="#cb21-4"></a>NMDS2 <span class="ot">=</span> <span class="fu">metaMDS</span>(dune, <span class="at">distance=</span><span class="st">"euclidean"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Run 0 stress 0.1174523 
Run 1 stress 0.1174523 
... Procrustes: rmse 3.580249e-06  max resid 1.150625e-05 
... Similar to previous best
Run 2 stress 0.1174523 
... Procrustes: rmse 2.054651e-06  max resid 3.818306e-06 
... Similar to previous best
Run 3 stress 0.1174523 
... Procrustes: rmse 2.128171e-06  max resid 5.656827e-06 
... Similar to previous best
Run 4 stress 0.1174523 
... Procrustes: rmse 2.022272e-06  max resid 6.26572e-06 
... Similar to previous best
Run 5 stress 0.1174523 
... Procrustes: rmse 2.488733e-06  max resid 8.218602e-06 
... Similar to previous best
Run 6 stress 0.1177339 
... Procrustes: rmse 0.01706434  max resid 0.05525565 
Run 7 stress 0.1174523 
... New best solution
... Procrustes: rmse 1.353658e-06  max resid 2.894393e-06 
... Similar to previous best
Run 8 stress 0.1174523 
... Procrustes: rmse 1.402024e-06  max resid 4.031045e-06 
... Similar to previous best
Run 9 stress 0.1174523 
... Procrustes: rmse 2.805576e-06  max resid 7.787809e-06 
... Similar to previous best
Run 10 stress 0.1174523 
... Procrustes: rmse 1.140971e-06  max resid 2.993735e-06 
... Similar to previous best
Run 11 stress 0.1177339 
... Procrustes: rmse 0.0170643  max resid 0.05525551 
Run 12 stress 0.1174523 
... Procrustes: rmse 1.964847e-06  max resid 5.765074e-06 
... Similar to previous best
Run 13 stress 0.1174523 
... Procrustes: rmse 1.231263e-06  max resid 2.345061e-06 
... Similar to previous best
Run 14 stress 0.1174523 
... Procrustes: rmse 1.05504e-06  max resid 2.45264e-06 
... Similar to previous best
Run 15 stress 0.1177339 
... Procrustes: rmse 0.01706422  max resid 0.05525614 
Run 16 stress 0.1177339 
... Procrustes: rmse 0.01706442  max resid 0.05525521 
Run 17 stress 0.1177339 
... Procrustes: rmse 0.01706456  max resid 0.05525899 
Run 18 stress 0.1177339 
... Procrustes: rmse 0.01706413  max resid 0.05525604 
Run 19 stress 0.1177339 
... Procrustes: rmse 0.01706403  max resid 0.05525579 
Run 20 stress 0.1174523 
... Procrustes: rmse 2.00709e-06  max resid 5.652376e-06 
... Similar to previous best
*** Best solution repeated 8 times</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>NMDS2 </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
metaMDS(comm = dune, distance = "euclidean") 

global Multidimensional Scaling using monoMDS

Data:     dune 
Distance: euclidean 

Dimensions: 2 
Stress:     0.1174523 
Stress type 1, weak ties
Best solution was repeated 8 times in 20 tries
The best solution was from try 7 (random start)
Scaling: centring, PC rotation 
Species: expanded scores based on 'dune' </code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="fu">ordiplot</span>(NMDS2, <span class="at">type =</span> <span class="st">"t"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="7-Multivariate_files/figure-html/unnamed-chunk-2-6.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="co"># Method 2: constrained  ------------------------------------------------</span></span>
<span id="cb26-2"><a href="#cb26-2"></a></span>
<span id="cb26-3"><a href="#cb26-3"></a></span>
<span id="cb26-4"><a href="#cb26-4"></a><span class="co"># 2 multivariate datasets (abundances + environment)</span></span>
<span id="cb26-5"><a href="#cb26-5"></a></span>
<span id="cb26-6"><a href="#cb26-6"></a></span>
<span id="cb26-7"><a href="#cb26-7"></a><span class="do">## RDA</span></span>
<span id="cb26-8"><a href="#cb26-8"></a><span class="fu">str</span>(dune) <span class="co"># species composition</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   20 obs. of  30 variables:
 $ Achimill: num  1 3 0 0 2 2 2 0 0 4 ...
 $ Agrostol: num  0 0 4 8 0 0 0 4 3 0 ...
 $ Airaprae: num  0 0 0 0 0 0 0 0 0 0 ...
 $ Alopgeni: num  0 2 7 2 0 0 0 5 3 0 ...
 $ Anthodor: num  0 0 0 0 4 3 2 0 0 4 ...
 $ Bellpere: num  0 3 2 2 2 0 0 0 0 2 ...
 $ Bromhord: num  0 4 0 3 2 0 2 0 0 4 ...
 $ Chenalbu: num  0 0 0 0 0 0 0 0 0 0 ...
 $ Cirsarve: num  0 0 0 2 0 0 0 0 0 0 ...
 $ Comapalu: num  0 0 0 0 0 0 0 0 0 0 ...
 $ Eleopalu: num  0 0 0 0 0 0 0 4 0 0 ...
 $ Elymrepe: num  4 4 4 4 4 0 0 0 6 0 ...
 $ Empenigr: num  0 0 0 0 0 0 0 0 0 0 ...
 $ Hyporadi: num  0 0 0 0 0 0 0 0 0 0 ...
 $ Juncarti: num  0 0 0 0 0 0 0 4 4 0 ...
 $ Juncbufo: num  0 0 0 0 0 0 2 0 4 0 ...
 $ Lolipere: num  7 5 6 5 2 6 6 4 2 6 ...
 $ Planlanc: num  0 0 0 0 5 5 5 0 0 3 ...
 $ Poaprat : num  4 4 5 4 2 3 4 4 4 4 ...
 $ Poatriv : num  2 7 6 5 6 4 5 4 5 4 ...
 $ Ranuflam: num  0 0 0 0 0 0 0 2 0 0 ...
 $ Rumeacet: num  0 0 0 0 5 6 3 0 2 0 ...
 $ Sagiproc: num  0 0 0 5 0 0 0 2 2 0 ...
 $ Salirepe: num  0 0 0 0 0 0 0 0 0 0 ...
 $ Scorautu: num  0 5 2 2 3 3 3 3 2 3 ...
 $ Trifprat: num  0 0 0 0 2 5 2 0 0 0 ...
 $ Trifrepe: num  0 5 2 1 2 5 2 2 3 6 ...
 $ Vicilath: num  0 0 0 0 0 0 0 0 0 1 ...
 $ Bracruta: num  0 0 2 2 2 6 2 2 2 2 ...
 $ Callcusp: num  0 0 0 0 0 0 0 0 0 0 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="fu">data</span>(<span class="st">"dune.env"</span>)</span>
<span id="cb28-2"><a href="#cb28-2"></a><span class="fu">str</span>(dune.env) <span class="co"># environmental variables</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   20 obs. of  5 variables:
 $ A1        : num  2.8 3.5 4.3 4.2 6.3 4.3 2.8 4.2 3.7 3.3 ...
 $ Moisture  : Ord.factor w/ 4 levels "1"&lt;"2"&lt;"4"&lt;"5": 1 1 2 2 1 1 1 4 3 2 ...
 $ Management: Factor w/ 4 levels "BF","HF","NM",..: 4 1 4 4 2 2 2 2 2 1 ...
 $ Use       : Ord.factor w/ 3 levels "Hayfield"&lt;"Haypastu"&lt;..: 2 2 2 2 1 2 3 3 1 1 ...
 $ Manure    : Ord.factor w/ 5 levels "0"&lt;"1"&lt;"2"&lt;"3"&lt;..: 5 3 5 5 3 3 4 4 2 2 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>RDA <span class="ot">=</span> <span class="fu">rda</span>(dune <span class="sc">~</span> <span class="fu">as.numeric</span>(Manure) <span class="sc">+</span> <span class="fu">as.numeric</span>(Moisture), </span>
<span id="cb30-2"><a href="#cb30-2"></a>         <span class="at">data =</span> dune.env)</span>
<span id="cb30-3"><a href="#cb30-3"></a><span class="fu">plot</span>(RDA)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="7-Multivariate_files/figure-html/unnamed-chunk-2-7.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="fu">summary</span>(RDA)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
rda(formula = dune ~ as.numeric(Manure) + as.numeric(Moisture),      data = dune.env) 

Partitioning of variance:
              Inertia Proportion
Total           84.12     1.0000
Constrained     31.20     0.3709
Unconstrained   52.92     0.6291

Eigenvalues, and their contribution to the variance 

Importance of components:
                         RDA1    RDA2     PC1     PC2     PC3    PC4     PC5
Eigenvalue            19.0185 12.1864 10.7889 7.85393 6.67657 6.2084 5.12380
Proportion Explained   0.2261  0.1449  0.1283 0.09336 0.07937 0.0738 0.06091
Cumulative Proportion  0.2261  0.3709  0.4992 0.59255 0.67192 0.7457 0.80663
                          PC6     PC7     PC8     PC9    PC10    PC11    PC12
Eigenvalue            3.50320 3.10988 2.47760 1.83130 1.63276 1.03305 0.87265
Proportion Explained  0.04164 0.03697 0.02945 0.02177 0.01941 0.01228 0.01037
Cumulative Proportion 0.84827 0.88524 0.91469 0.93646 0.95587 0.96815 0.97852
                          PC13     PC14     PC15     PC16     PC17
Eigenvalue            0.642862 0.469072 0.301387 0.215853 0.177610
Proportion Explained  0.007642 0.005576 0.003583 0.002566 0.002111
Cumulative Proportion 0.986164 0.991740 0.995323 0.997889 1.000000

Accumulated constrained eigenvalues
Importance of components:
                         RDA1    RDA2
Eigenvalue            19.0185 12.1864
Proportion Explained   0.6095  0.3905
Cumulative Proportion  0.6095  1.0000

Scaling 2 for species and site scores
* Species are scaled proportional to eigenvalues
* Sites are unscaled: weighted dispersion equal on all dimensions
* General scaling constant of scores:  6.322924 


Species scores

             RDA1     RDA2       PC1        PC2        PC3      PC4
Achimill -0.47851  0.09403 -0.235988 -0.3197353  0.3103983 -0.28427
Agrostol  1.23296 -0.81601  0.315190  0.4660974 -0.5315336 -0.32248
Airaprae  0.09460  0.19968 -0.076754 -0.0507504  0.2022189  0.36738
Alopgeni  0.62089 -1.06991 -0.607808  0.4085202 -0.7675817  0.14890
Anthodor -0.30489  0.37796 -0.285364 -0.7314654  0.3530155  0.28189
Bellpere -0.35166 -0.06186 -0.191560  0.2159228  0.0656089 -0.21926
Bromhord -0.40174 -0.11438 -0.328850  0.0020272  0.3311781 -0.38313
Chenalbu  0.04451 -0.03993 -0.058797 -0.0133695 -0.0062794  0.01141
Cirsarve -0.02004 -0.10831  0.015724  0.0909001  0.0063718  0.02241
Comapalu  0.16471  0.14225  0.075038  0.0042984  0.0452944 -0.15780
Eleopalu  1.06943 -0.01682  0.956570 -0.1633735 -0.0681172 -0.57630
Elymrepe -0.46520 -0.51974 -0.379373  0.6613239 -0.0042671 -0.34204
Empenigr  0.08235  0.07112 -0.057452 -0.0408164  0.1097807  0.19686
Hyporadi  0.09461  0.32440 -0.082603 -0.0367101  0.3251675  0.62435
Juncarti  0.65768  0.03291  0.308049  0.1056579 -0.2072807 -0.34406
Juncbufo  0.17582 -0.14056 -0.532656  0.0587424 -0.4920012  0.08088
Lolipere -1.37550 -0.76492  0.066647  0.0244836  0.5992907 -0.19415
Planlanc -0.91473  0.29200  0.034350 -0.8292224 -0.1507798 -0.02191
Poaprat  -0.79237 -0.54275 -0.258875  0.2664459  0.2614175 -0.18998
Poatriv  -0.31279 -1.25438 -1.230700 -0.1907205 -0.2493570 -0.49014
Ranuflam  0.59648  0.04493  0.299763 -0.0445985 -0.0309806 -0.25792
Rumeacet -0.49744 -0.03945 -0.219023 -0.8330211 -0.5462675 -0.10570
Sagiproc  0.26038 -0.27567 -0.367494  0.2918690 -0.1864142  0.53458
Salirepe  0.20256  0.44038  0.242168  0.1056696 -0.0521776  0.24572
Scorautu -0.30711  0.52183 -0.365094 -0.0004242  0.1648603  0.30468
Trifprat -0.35833 -0.03560  0.006885 -0.6508879 -0.2073384 -0.06693
Trifrepe -0.23813  0.30248 -0.700492 -0.2593107  0.1604908 -0.54832
Vicilath -0.13798  0.12689  0.043562  0.0653852  0.0278102  0.03656
Bracruta -0.07231  0.35720  0.477998 -0.2964003 -0.7549203  0.23978
Callcusp  0.42177  0.12915  0.374847 -0.0305725  0.0002153 -0.33309


Site scores (weighted sums of species scores)

       RDA1     RDA2     PC1       PC2     PC3     PC4
1  -1.20433 -0.66993  1.9859  1.074660  2.0108  0.8005
2  -1.63761 -1.22512 -1.8071  1.724159  1.1211 -2.1875
3  -0.41325 -2.98426 -0.3938  1.380869 -0.1922  0.1239
4   0.09600 -2.56866  0.3143  1.817064  0.1274  0.4481
5  -1.79219  0.23179 -0.7176 -1.888869 -0.8907 -0.7317
6  -2.29807  0.77565  0.2429 -3.590960 -1.4197 -0.2869
7  -2.04152 -0.05247  0.2480 -2.144774  0.2954  0.1111
8   1.11426 -1.42188  0.1640 -0.499303  0.9258 -0.0638
9   0.17152 -1.55487 -2.1156  1.667963 -1.4793 -1.2478
10 -2.05972  0.47751 -1.4807 -1.049874  2.3911 -1.6675
11 -1.41282  1.17178  1.0315  1.096567  0.2632  1.2017
12  1.40040 -1.21998 -1.5692  0.392422 -3.3976  1.6584
13  1.21063 -2.23426 -2.3507 -0.534503 -0.2510  0.4563
14  1.68764  1.47758  0.1848 -0.008859  1.1639 -2.1575
15  1.93732  1.38809  1.3152  0.094782 -0.2584 -0.9969
16  3.10493 -0.43010  2.8191 -0.847596 -0.8985 -0.7305
17 -0.01732  2.06719  0.1884  0.209376  0.7506  1.4412
18 -0.62775  2.16502  1.1592  1.470799 -1.8057  0.7257
19  0.37978  2.98990 -1.1484 -0.815907  2.1945  3.9351
20  2.40211  1.61704  1.9299  0.451985 -0.6505 -0.8317


Site constraints (linear combinations of constraining variables)

      RDA1    RDA2     PC1       PC2     PC3     PC4
1  -1.5128 -1.9466  1.9859  1.074660  2.0108  0.8005
2  -1.6016  0.0654 -1.8071  1.724159  1.1211 -2.1875
3  -0.4006 -2.1652 -0.3938  1.380869 -0.1922  0.1239
4  -0.4006 -2.1652  0.3143  1.817064  0.1274  0.4481
5  -1.6016  0.0654 -0.7176 -1.888869 -0.8907 -0.7317
6  -1.6016  0.0654  0.2429 -3.590960 -1.4197 -0.2869
7  -1.5572 -0.9406  0.2480 -2.144774  0.2954  0.1111
8   1.7795 -1.5963  0.1640 -0.499303  0.9258 -0.0638
9   0.5784  0.6343 -2.1156  1.667963 -1.4793 -1.2478
10 -0.5338  0.8529 -1.4807 -1.049874  2.3911 -1.6675
11 -1.6461  1.0714  1.0315  1.096567  0.2632  1.2017
12  0.6228 -0.3717 -1.5692  0.392422 -3.3976  1.6584
13  1.7795 -1.5963 -2.3507 -0.534503 -0.2510  0.4563
14  1.6462  1.4218  0.1848 -0.008859  1.1639 -2.1575
15  1.6462  1.4218  1.3152  0.094782 -0.2584 -0.9969
16  1.7795 -1.5963  2.8191 -0.847596 -0.8985 -0.7305
17 -0.5783  1.8589  0.1884  0.209376  0.7506  1.4412
18 -1.6905  2.0774  1.1592  1.470799 -1.8057  0.7257
19  1.6462  1.4218 -1.1484 -0.815907  2.1945  3.9351
20  1.6462  1.4218  1.9299  0.451985 -0.6505 -0.8317


Biplot scores for constraining variables

                        RDA1     RDA2 PC1 PC2 PC3 PC4
as.numeric(Manure)   -0.1928 -0.98124   0   0   0   0
as.numeric(Moisture)  0.9990  0.04412   0   0   0   0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="co"># important part at the top</span></span>
<span id="cb33-2"><a href="#cb33-2"></a><span class="co"># variance explained by the two variables = prop constrained = 37.09%</span></span>
<span id="cb33-3"><a href="#cb33-3"></a><span class="co"># how much is explained by each RDA = see importance of components prop explained</span></span>
<span id="cb33-4"><a href="#cb33-4"></a><span class="co"># PCs are the unconstrained axes</span></span>
<span id="cb33-5"><a href="#cb33-5"></a></span>
<span id="cb33-6"><a href="#cb33-6"></a><span class="co"># species scores = coordinates of species in the plot</span></span>
<span id="cb33-7"><a href="#cb33-7"></a><span class="co"># site scores = coordinates of sites in the plot</span></span>
<span id="cb33-8"><a href="#cb33-8"></a><span class="co"># biplot scores = coordinates of environmental variable vectors</span></span>
<span id="cb33-9"><a href="#cb33-9"></a></span>
<span id="cb33-10"><a href="#cb33-10"></a></span>
<span id="cb33-11"><a href="#cb33-11"></a><span class="fu">barplot</span>(<span class="fu">summary</span>(RDA)<span class="sc">$</span>cont<span class="sc">$</span>importance[<span class="dv">2</span>, ],  <span class="at">las =</span> <span class="dv">2</span>,</span>
<span id="cb33-12"><a href="#cb33-12"></a>        <span class="at">col =</span> <span class="fu">c</span>(<span class="fu">rep</span> (<span class="st">'red'</span>, <span class="dv">2</span>), </span>
<span id="cb33-13"><a href="#cb33-13"></a>                <span class="fu">rep</span> (<span class="st">'black'</span>, <span class="fu">length</span>(<span class="fu">summary</span>(RDA)<span class="sc">$</span>cont<span class="sc">$</span>importance[<span class="dv">2</span>, ])<span class="sc">-</span><span class="dv">2</span>)),</span>
<span id="cb33-14"><a href="#cb33-14"></a>        <span class="at">ylab=</span><span class="st">"proportion of variance explained"</span>) <span class="co"># displays % of variance explained by PCs</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="7-Multivariate_files/figure-html/unnamed-chunk-2-8.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="co"># Method 3: Clustering ---------------------------------------------------</span></span>
<span id="cb34-2"><a href="#cb34-2"></a></span>
<span id="cb34-3"><a href="#cb34-3"></a><span class="co"># hierarchical clustering: </span></span>
<span id="cb34-4"><a href="#cb34-4"></a></span>
<span id="cb34-5"><a href="#cb34-5"></a><span class="fu">library</span>(cluster) <span class="co"># clustering</span></span>
<span id="cb34-6"><a href="#cb34-6"></a><span class="fu">library</span>(ape) <span class="co"># phylogenetic analyses, here to get pretty dendrogram</span></span>
<span id="cb34-7"><a href="#cb34-7"></a></span>
<span id="cb34-8"><a href="#cb34-8"></a><span class="co"># example for distance matrix</span></span>
<span id="cb34-9"><a href="#cb34-9"></a><span class="fu">dist</span>(iris[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]) <span class="co"># creates a distance matrix (comparison of all possible sample pairs), </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          1         2
2 0.5385165          
3 0.5099020 0.3000000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="co"># default method ="euclidean", but can be changed</span></span>
<span id="cb36-2"><a href="#cb36-2"></a></span>
<span id="cb36-3"><a href="#cb36-3"></a><span class="co"># get Hierarchical Clustering</span></span>
<span id="cb36-4"><a href="#cb36-4"></a>hc <span class="ot">=</span> <span class="fu">hclust</span>(<span class="fu">dist</span>(iris[, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]))</span>
<span id="cb36-5"><a href="#cb36-5"></a><span class="fu">plot</span>(hc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="7-Multivariate_files/figure-html/unnamed-chunk-2-9.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="co"># for colors use package ape</span></span>
<span id="cb37-2"><a href="#cb37-2"></a><span class="fu">plot</span>(<span class="fu">as.phylo</span>(hc), <span class="at">tip.color =</span> <span class="fu">as.numeric</span>(iris<span class="sc">$</span>Species)) <span class="co"># as.phylo converts object type "hcclust" into object type "phylo"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="7-Multivariate_files/figure-html/unnamed-chunk-2-10.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="co"># change plotting type:</span></span>
<span id="cb38-2"><a href="#cb38-2"></a><span class="fu">plot</span>(<span class="fu">as.phylo</span>(hc), <span class="at">tip.color =</span> <span class="fu">as.numeric</span>(iris<span class="sc">$</span>Species), <span class="at">type =</span> <span class="st">"fan"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="7-Multivariate_files/figure-html/unnamed-chunk-2-11.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="co"># lets try another clustering algorithm</span></span>
<span id="cb39-2"><a href="#cb39-2"></a><span class="fu">data</span>(animals)</span>
<span id="cb39-3"><a href="#cb39-3"></a><span class="fu">str</span>(animals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   20 obs. of  6 variables:
 $ war: int  1 1 2 1 2 2 2 2 2 1 ...
 $ fly: int  1 2 1 1 1 1 2 2 1 2 ...
 $ ver: int  1 1 2 1 2 2 2 2 2 1 ...
 $ end: int  1 1 1 1 2 1 1 2 2 1 ...
 $ gro: int  2 2 1 1 2 2 2 1 2 1 ...
 $ hai: int  1 2 2 2 2 2 1 1 1 1 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="co"># Agglomerative Nesting </span></span>
<span id="cb41-2"><a href="#cb41-2"></a>aa <span class="ot">&lt;-</span> <span class="fu">agnes</span>(animals)</span>
<span id="cb41-3"><a href="#cb41-3"></a><span class="fu">plot</span>(aa, <span class="at">which.plots =</span> <span class="dv">2</span>) <span class="co">#which.plots: plots only plot 2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="7-Multivariate_files/figure-html/unnamed-chunk-2-12.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a><span class="co"># first is banner plot...</span></span>
<span id="cb42-2"><a href="#cb42-2"></a></span>
<span id="cb42-3"><a href="#cb42-3"></a></span>
<span id="cb42-4"><a href="#cb42-4"></a></span>
<span id="cb42-5"><a href="#cb42-5"></a><span class="do">### non-hierarchical</span></span>
<span id="cb42-6"><a href="#cb42-6"></a><span class="co"># kmeans </span></span>
<span id="cb42-7"><a href="#cb42-7"></a></span>
<span id="cb42-8"><a href="#cb42-8"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co"># choice of first k centers is random and depends on (random) seed</span></span>
<span id="cb42-9"><a href="#cb42-9"></a>cl <span class="ot">=</span> <span class="fu">kmeans</span>(iris[, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="at">centers =</span> <span class="dv">3</span>) <span class="co"># centers = number of clusters to be generated</span></span>
<span id="cb42-10"><a href="#cb42-10"></a></span>
<span id="cb42-11"><a href="#cb42-11"></a>cl<span class="sc">$</span>cluster</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 [38] 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 3 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
 [75] 2 2 2 3 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 2 3 3 3 3 2 3 3 3 3
[112] 3 3 2 2 3 3 3 3 2 3 2 3 2 3 3 2 2 3 3 3 3 3 2 3 3 3 3 2 3 3 3 2 3 3 3 2 3
[149] 3 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="fu">as.numeric</span>(iris<span class="sc">$</span>Species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 [38] 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
 [75] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 3 3 3 3 3 3 3 3 3 3
[112] 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
[149] 3 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="co"># without the same seed you may have to exchange cluster 2 and 3 to be able to compare assignment to species with real species in the plot</span></span>
<span id="cb46-2"><a href="#cb46-2"></a>temp <span class="ot">=</span> cl<span class="sc">$</span>cluster</span>
<span id="cb46-3"><a href="#cb46-3"></a><span class="co"># temp[cl$cluster==2] = 3</span></span>
<span id="cb46-4"><a href="#cb46-4"></a><span class="co"># temp[cl$cluster==3] = 2</span></span>
<span id="cb46-5"><a href="#cb46-5"></a></span>
<span id="cb46-6"><a href="#cb46-6"></a>temp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 [38] 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 3 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
 [75] 2 2 2 3 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 2 3 3 3 3 2 3 3 3 3
[112] 3 3 2 2 3 3 3 3 2 3 2 3 2 3 3 2 2 3 3 3 3 3 2 3 3 3 3 2 3 3 3 2 3 3 3 2 3
[149] 3 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a><span class="fu">as.numeric</span>(iris<span class="sc">$</span>Species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 [38] 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
 [75] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 3 3 3 3 3 3 3 3 3 3
[112] 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
[149] 3 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a><span class="co"># original species</span></span>
<span id="cb50-2"><a href="#cb50-2"></a><span class="fu">pairs</span>(iris[, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="at">col =</span> <span class="fu">as.numeric</span>(iris<span class="sc">$</span>Species)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="7-Multivariate_files/figure-html/unnamed-chunk-2-13.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a><span class="co"># species found by cluster</span></span>
<span id="cb51-2"><a href="#cb51-2"></a><span class="fu">pairs</span>(iris[, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="at">col =</span> temp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="7-Multivariate_files/figure-html/unnamed-chunk-2-14.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a><span class="co"># display samples that have been assigned to the wrong species</span></span>
<span id="cb52-2"><a href="#cb52-2"></a>same <span class="ot">=</span> <span class="fu">as.numeric</span>(iris<span class="sc">$</span>Species) <span class="sc">==</span> temp</span>
<span id="cb52-3"><a href="#cb52-3"></a><span class="fu">pairs</span>(iris[, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="at">col =</span> <span class="fu">as.numeric</span>(same) <span class="sc">+</span> <span class="dv">1</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="7-Multivariate_files/figure-html/unnamed-chunk-2-15.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a><span class="fu">palette</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "black"   "#DF536B" "#61D04F" "#2297E6" "#28E2E5" "#CD0BBC" "#F5C710"
[8] "gray62" </code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a><span class="co"># HERE EXERCISE WITH BREAKOUT SESSION</span></span>
<span id="cb55-2"><a href="#cb55-2"></a></span>
<span id="cb55-3"><a href="#cb55-3"></a></span>
<span id="cb55-4"><a href="#cb55-4"></a></span>
<span id="cb55-5"><a href="#cb55-5"></a></span>
<span id="cb55-6"><a href="#cb55-6"></a><span class="co"># Attention ---------------------------------------------------------------</span></span>
<span id="cb55-7"><a href="#cb55-7"></a></span>
<span id="cb55-8"><a href="#cb55-8"></a></span>
<span id="cb55-9"><a href="#cb55-9"></a></span>
<span id="cb55-10"><a href="#cb55-10"></a><span class="do">##### type (or copy) the following while students work on their exercise</span></span>
<span id="cb55-11"><a href="#cb55-11"></a><span class="co"># Why we should be careful when interpreting patterns in ordination plots</span></span>
<span id="cb55-12"><a href="#cb55-12"></a></span>
<span id="cb55-13"><a href="#cb55-13"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb55-14"><a href="#cb55-14"></a></span>
<span id="cb55-15"><a href="#cb55-15"></a>random <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">pollution =</span> <span class="fu">rnorm</span>(<span class="dv">30</span>),</span>
<span id="cb55-16"><a href="#cb55-16"></a>                    <span class="at">temperature =</span> <span class="fu">rnorm</span>(<span class="dv">30</span>),</span>
<span id="cb55-17"><a href="#cb55-17"></a>                    <span class="at">moisture =</span> <span class="fu">rnorm</span>(<span class="dv">30</span>),</span>
<span id="cb55-18"><a href="#cb55-18"></a>                    <span class="at">tourists =</span> <span class="fu">rnorm</span>(<span class="dv">30</span>),</span>
<span id="cb55-19"><a href="#cb55-19"></a>                    <span class="at">wind =</span> <span class="fu">rnorm</span>(<span class="dv">30</span>),</span>
<span id="cb55-20"><a href="#cb55-20"></a>                    <span class="at">dogs =</span> <span class="fu">rnorm</span>(<span class="dv">30</span>))</span>
<span id="cb55-21"><a href="#cb55-21"></a><span class="fu">head</span>(random)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    pollution temperature   moisture   tourists       wind       dogs
1 -0.56047565   0.4264642  0.3796395  0.9935039  0.1176466  0.7877388
2 -0.23017749  -0.2950715 -0.5023235  0.5483970 -0.9474746  0.7690422
3  1.55870831   0.8951257 -0.3332074  0.2387317 -0.4905574  0.3322026
4  0.07050839   0.8781335 -1.0185754 -0.6279061 -0.2560922 -1.0083766
5  0.12928774   0.8215811 -1.0717912  1.3606524  1.8438620 -0.1194526
6  1.71506499   0.6886403  0.3035286 -0.6002596 -0.6519499 -0.2803953</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a>pca <span class="ot">=</span> <span class="fu">prcomp</span>(random, <span class="at">scale =</span> T)</span>
<span id="cb57-2"><a href="#cb57-2"></a><span class="fu">biplot</span>(pca)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="7-Multivariate_files/figure-html/unnamed-chunk-2-16.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="exercises" class="level2" data-number="7.2"><h2 data-number="7.2" class="anchored" data-anchor-id="exercises">
<span class="header-section-number">7.2</span> Exercises</h2>
<div class="cell">

</div>
<p>In this exercise you will practice analyzing multivariate datasets using:</p>
<ul>
<li>ordination methods which explore higher-order correlations among variables and similarities between observations</li>
<li>clustering methods which aggregate individual observations into clusters.</li>
</ul>
<section id="useful-functions-for-multivariate-data-analyses" class="level4" data-number="7.2.0.1"><h4 data-number="7.2.0.1" class="anchored" data-anchor-id="useful-functions-for-multivariate-data-analyses">
<span class="header-section-number">7.2.0.1</span> Useful functions for multivariate data analyses</h4>
<p><em>pairs()</em> - create pairplot (plot all variables against each other)<br><em>prcomp()</em> - calculate PCA<br><em>plot(pca_object)</em> - plot variance explained by PC axes<br><em>biplot()</em> - plot PCA<br><em>metaMDS()</em> - calculate NMDS<br><em>ordiplot(nmds_object)</em> - plot NMDS<br><em>rda()</em> - calculate RDA<br><em>plot(rda_object)</em> - plot RDA<br><em>dist()</em> - create distance matrix<br><em>hclust()</em> - perform hierarchical clustering; apply to distance matrix<br><em>plot(as.phylo(hc_object))</em> - plot dendrogram from hclust output<br><em>agnes()</em> - another clustering algorithm<br><em>kmeans()</em> - perform kmeans non-hierarchical clustering; access cluster assignments using <em>kmeans_object$cluster</em></p>
</section><section id="background-on-the-dataset" class="level4" data-number="7.2.0.2"><h4 data-number="7.2.0.2" class="anchored" data-anchor-id="background-on-the-dataset">
<span class="header-section-number">7.2.0.2</span> Background on the dataset</h4>
<p>Marine coastal ecosystems harbor the most productive and diverse communities on Earth. However, they are extremely vulnerable to climate change and human activities (such as landclaim, pollution, recreation purposes, …) As a consequence, the performance of this ecosystem has decreased considerably. To better understand these ecosystems, the dutch governmental institute (RIKZ: Rijksinstituut voor Kust en Zee) started a research project on sandy beaches to investigate the relationship between environmental factors and how they might affect benthic fauna. <em>(from the LMU and Zuur, Ieno, Smith (2007), Chapter 12.8-12.10 and 27)</em></p>
<p><strong>Question</strong><br>
We now want to use ordination methods to explore</p>
<ul>
<li>the variability in environmental conditions</li>
<li>the variability in species richness</li>
</ul>
<p>We also want to use clustering methods to define 3 environmental types and hierarchically cluster the samples with respect to their species richness.</p>
<p><strong>Dataset</strong></p>
<p>Read in the dataset as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a>dat <span class="ot">=</span> <span class="fu">read.table</span>(<span class="at">file =</span> <span class="st">"http://evol.bio.lmu.de/_statgen/Multivariate/11SS/RIKZGroups.txt"</span>, <span class="at">header =</span> T)</span>
<span id="cb58-2"><a href="#cb58-2"></a><span class="fu">head</span>(dat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You already know the functions <em>str()</em> and <em>summary()</em> to get an overview of a dataset and to see which variables the dataset contains.</p>
<ul>
<li>columns 2:5 is <strong>species richness</strong> within four larger faunal groups</li>
<li>columns 7:16 are different <strong>environmental variables</strong>
</li>
</ul>
<p>Not important for us are:</p>
<ul>
<li>column 6 (week), a time stamp<br>
</li>
<li>column 17 (sorting1), variable from the observational design</li>
</ul>
<p>Let’s get into the analysis!</p>
</section><section id="unconstrained-ordination-pca" class="level3" data-number="7.2.1"><h3 data-number="7.2.1" class="anchored" data-anchor-id="unconstrained-ordination-pca">
<span class="header-section-number">7.2.1</span> Unconstrained ordination (PCA)</h3>
<p>Carry out the following analyses:</p>
<ul>
<li>Make two PCAs, one for the environmental and one for the species richness data (see columns above).</li>
<li>Name the results <em>pca_environment</em> and <em>pca_species</em>.</li>
<li>Create a biplot for each PCA.</li>
<li>Create a barplot for the variance explained by each component.</li>
</ul>
<p>For example, the result for species richness should look like this:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="7-Multivariate_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>You need the following functions and the package <em>vegan</em>:</p>
<ul>
<li><em>prcomp()</em></li>
<li>
<em>biplot()</em><br>
</li>
<li><em>barplot()</em></li>
<li><em>summary()</em></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a><span class="fu">library</span>(vegan)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Hints</strong></p>
<ul>
<li>Don’t forget to scale the variables in the PCA.</li>
<li>In order to get the proportion of the explained variance, have a look at the summary of your analysis. <em>str()</em> shows you what the summary contains. You want to specifically look at the <em>importance</em>, here the second row contains the proportion of variance of all 4 components. So what we want to plot is: <em>summary(pca_species)$importance[2,1:4]</em>.</li>
<li>Don’t forget to give your plots a title.</li>
</ul>
<p>Now, use your results to <strong>answer the questions on elearning-extern</strong>.</p>
<ol type="1">
<li>In which multivariate dataset do the first and second components explain more variance?</li>
<li>Describe the following correlations:
<ol type="a">
<li>salinity and humus</li>
<li>angle1 and exposure</li>
<li>Crustacea and NAP</li>
<li>Polychaeta and Mollusca</li>
</ol>
</li>
<li>Which environmental variables would you choose, if you have only the resource to measure three variables?</li>
</ol></section><section id="clustering" class="level3" data-number="7.2.2"><h3 data-number="7.2.2" class="anchored" data-anchor-id="clustering">
<span class="header-section-number">7.2.2</span> Clustering</h3>
<section id="k-means" class="level4" data-number="7.2.2.1"><h4 data-number="7.2.2.1" class="anchored" data-anchor-id="k-means">
<span class="header-section-number">7.2.2.1</span> K-means</h4>
<p>We want to use clustering methods to define 3 environmental types. Use the function <em>kmeans()</em> with <em>centers = 3</em> (number of clusters to be generated). Remember to set a seed; the choice of the first k centers is random.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) </span>
<span id="cb60-2"><a href="#cb60-2"></a>cl <span class="ot">=</span> <span class="do">####</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Compare the three clusters with the result of the PCA using the following code that uses another plotting framework called ggplot2:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a><span class="fu">library</span>(ggfortify)</span>
<span id="cb61-2"><a href="#cb61-2"></a><span class="fu">autoplot</span>(pca_environment, <span class="at">colour =</span> cl<span class="sc">$</span>cluster, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">loadings =</span> <span class="cn">TRUE</span>, <span class="at">loadings.colour =</span> <span class="st">'black'</span>,</span>
<span id="cb61-3"><a href="#cb61-3"></a>         <span class="at">loadings.label =</span> <span class="cn">TRUE</span>, <span class="at">loadings.label.size =</span> <span class="dv">3</span>, <span class="at">loadings.label.colour =</span> <span class="st">"black"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The colors of the points represent the three clusters. <strong>Answer the following question on elearning-extern</strong>: How is it possible that four observations in the middle (in black if you have used the same seed) belong to a different cluster than the observations around them?</p>
</section><section id="hierarchical-clustering" class="level4" data-number="7.2.2.2"><h4 data-number="7.2.2.2" class="anchored" data-anchor-id="hierarchical-clustering">
<span class="header-section-number">7.2.2.2</span> Hierarchical clustering</h4>
<p>Now we want to hierarchically cluster the samples with respect to their species richness, as shown in the following plot:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="7-Multivariate_files/figure-html/clustering-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Create the same plot using the functions:</p>
<ul>
<li>
<em>hclust()</em><br>
</li>
<li><em>plot()</em></li>
<li><em>as.phylo()</em></li>
</ul>
<p>Have a look at the help for <em>hclust()</em> to read what the function does and look at the examples for further help on how to use the function. Then have a look at what the function <em>as.phylo()</em> does.</p>
<p>Now, color the labels using the variable <em>week</em>. You can do this using the argument “tip.color =”. Choose the correct statements about the species richness and its sampling on <strong>elearning-extern</strong>.</p>


</section></section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./6-GLM.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Generalized linear models</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./8-MachineLearning.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Machine Learning</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>