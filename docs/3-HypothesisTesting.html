<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.475">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Introduction to Data Science with R - 3&nbsp; Hypothesis Tests</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./4-SimpleRegression.html" rel="next">
<link href="./2-DescriptiveStatistics.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
<meta name="citation_title" content="[3]{.chapter-number}&nbsp; [Hypothesis Tests]{.chapter-title}">
<meta name="citation_fulltext_html_url" content="https://TheoreticalEcology.github.io/DataScienceInR//3-HypothesisTesting.html">
<meta name="citation_language" content="en">
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">
<span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Hypothesis Tests</span>
</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Introduction to Data Science with R</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/TheoreticalEcology/DataScienceInR" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
    <a href="" title="Share" id="sidebar-tool-dropdown-0" class="sidebar-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi bi-share"></i></a>
    <ul class="dropdown-menu" aria-labelledby="sidebar-tool-dropdown-0">
<li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=%7Curl%7C">
            <i class="bi bi-bi-twitter pe-1"></i>
          Twitter
          </a>
        </li>
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=%7Curl%7C">
            <i class="bi bi-bi-facebook pe-1"></i>
          Facebook
          </a>
        </li>
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=%7Curl%7C">
            <i class="bi bi-bi-linkedin pe-1"></i>
          LinkedIn
          </a>
        </li>
    </ul>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1-GettingStarted.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Getting Started with R</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2-DescriptiveStatistics.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Plotting and describing data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3-HypothesisTesting.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Hypothesis Tests</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./4-SimpleRegression.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Simple linear regression</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./5-MultipleRegression.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Multiple regression</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./6-GLM.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Generalized linear models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./7-Multivariate.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Multivariate Statistics</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./8-MachineLearning.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Machine Learning</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./9-DataScienceSkills.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Data handling</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-Outlook.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Outlook</span></a>
  </div>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#a-recipe-for-hypothesis-testing" id="toc-a-recipe-for-hypothesis-testing" class="nav-link active" data-scroll-target="#a-recipe-for-hypothesis-testing"><span class="toc-section-number">3.1</span>  A recipe for hypothesis testing</a></li>
  <li><a href="#t-test" id="toc-t-test" class="nav-link" data-scroll-target="#t-test"><span class="toc-section-number">3.2</span>  T-test</a></li>
  <li><a href="#type-i-error-rate" id="toc-type-i-error-rate" class="nav-link" data-scroll-target="#type-i-error-rate"><span class="toc-section-number">3.3</span>  Type I error rate</a></li>
  <li><a href="#type-ii-error-rate" id="toc-type-ii-error-rate" class="nav-link" data-scroll-target="#type-ii-error-rate"><span class="toc-section-number">3.4</span>  Type II error rate</a></li>
  <li><a href="#statistical-power" id="toc-statistical-power" class="nav-link" data-scroll-target="#statistical-power"><span class="toc-section-number">3.5</span>  Statistical power</a></li>
  <li><a href="#false-discovery-rate" id="toc-false-discovery-rate" class="nav-link" data-scroll-target="#false-discovery-rate"><span class="toc-section-number">3.6</span>  False discovery rate</a></li>
  <li><a href="#statistical-tests" id="toc-statistical-tests" class="nav-link" data-scroll-target="#statistical-tests"><span class="toc-section-number">3.7</span>  Statistical tests</a></li>
  <li>
<a href="#comparison-of-mean-of-two-or-more-groups" id="toc-comparison-of-mean-of-two-or-more-groups" class="nav-link" data-scroll-target="#comparison-of-mean-of-two-or-more-groups"><span class="toc-section-number">3.8</span>  Comparison of mean of two or more groups</a>
  <ul class="collapse">
<li><a href="#tests-for-2-groups" id="toc-tests-for-2-groups" class="nav-link" data-scroll-target="#tests-for-2-groups"><span class="toc-section-number">3.8.1</span>  Tests for 2 groups</a></li>
  <li><a href="#tests-for-2-groups-1" id="toc-tests-for-2-groups-1" class="nav-link" data-scroll-target="#tests-for-2-groups-1"><span class="toc-section-number">3.8.2</span>  Tests for &gt; 2 groups</a></li>
  </ul>
</li>
  <li>
<a href="#comparison-of-variances" id="toc-comparison-of-variances" class="nav-link" data-scroll-target="#comparison-of-variances"><span class="toc-section-number">3.9</span>  Comparison of variances</a>
  <ul class="collapse">
<li><a href="#f-test-for-two-normally-distributed-samples" id="toc-f-test-for-two-normally-distributed-samples" class="nav-link" data-scroll-target="#f-test-for-two-normally-distributed-samples"><span class="toc-section-number">3.9.1</span>  F-Test for two normally-distributed samples</a></li>
  <li><a href="#bartlett-test-for-more-than-two-normally-distributed-samples" id="toc-bartlett-test-for-more-than-two-normally-distributed-samples" class="nav-link" data-scroll-target="#bartlett-test-for-more-than-two-normally-distributed-samples"><span class="toc-section-number">3.9.2</span>  Bartlett test for more than two normally-distributed samples</a></li>
  </ul>
</li>
  <li>
<a href="#comparison-of-discrete-proportions" id="toc-comparison-of-discrete-proportions" class="nav-link" data-scroll-target="#comparison-of-discrete-proportions"><span class="toc-section-number">3.10</span>  Comparison of discrete proportions</a>
  <ul class="collapse">
<li><a href="#exact-binomial-test" id="toc-exact-binomial-test" class="nav-link" data-scroll-target="#exact-binomial-test"><span class="toc-section-number">3.10.1</span>  Exact Binomial Test</a></li>
  <li><a href="#test-of-equal-or-given-proportions" id="toc-test-of-equal-or-given-proportions" class="nav-link" data-scroll-target="#test-of-equal-or-given-proportions"><span class="toc-section-number">3.10.2</span>  Test of Equal or Given Proportions</a></li>
  <li><a href="#contingency-tables" id="toc-contingency-tables" class="nav-link" data-scroll-target="#contingency-tables"><span class="toc-section-number">3.10.3</span>  Contingency tables</a></li>
  </ul>
</li>
  <li>
<a href="#distribution-tests" id="toc-distribution-tests" class="nav-link" data-scroll-target="#distribution-tests"><span class="toc-section-number">3.11</span>  Distribution tests</a>
  <ul class="collapse">
<li><a href="#shapiro-wilk-normality-test" id="toc-shapiro-wilk-normality-test" class="nav-link" data-scroll-target="#shapiro-wilk-normality-test"><span class="toc-section-number">3.11.1</span>  Shapiro-Wilk Normality Test</a></li>
  <li><a href="#kolmogorov-smirnov-test" id="toc-kolmogorov-smirnov-test" class="nav-link" data-scroll-target="#kolmogorov-smirnov-test"><span class="toc-section-number">3.11.2</span>  Kolmogorov-Smirnov Test</a></li>
  </ul>
</li>
  <li>
<a href="#other-tests" id="toc-other-tests" class="nav-link" data-scroll-target="#other-tests"><span class="toc-section-number">3.12</span>  Other tests</a>
  <ul class="collapse">
<li><a href="#correlation" id="toc-correlation" class="nav-link" data-scroll-target="#correlation"><span class="toc-section-number">3.12.1</span>  Correlation</a></li>
  <li><a href="#mantel-test" id="toc-mantel-test" class="nav-link" data-scroll-target="#mantel-test"><span class="toc-section-number">3.12.2</span>  Mantel test</a></li>
  </ul>
</li>
  <li>
<a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="toc-section-number">3.13</span>  Exercises</a>
  <ul class="collapse">
<li><a href="#streams" id="toc-streams" class="nav-link" data-scroll-target="#streams"><span class="toc-section-number">3.13.1</span>  Streams</a></li>
  <li><a href="#chicken" id="toc-chicken" class="nav-link" data-scroll-target="#chicken"><span class="toc-section-number">3.13.2</span>  Chicken</a></li>
  <li><a href="#titanic" id="toc-titanic" class="nav-link" data-scroll-target="#titanic"><span class="toc-section-number">3.13.3</span>  Titanic</a></li>
  <li><a href="#simulation-of-type-i-and-ii-error" id="toc-simulation-of-type-i-and-ii-error" class="nav-link" data-scroll-target="#simulation-of-type-i-and-ii-error"><span class="toc-section-number">3.13.4</span>  Simulation of Type I and II error</a></li>
  </ul>
</li>
  </ul><div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/TheoreticalEcology/DataScienceInR/edit/master/3-HypothesisTesting.qmd" class="toc-action">Edit this page</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title d-none d-lg-block">
<span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Hypothesis Tests</span>
</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><p>In this section you will:</p>
<ul>
<li>get to know the most common hypothesis tests</li>
<li>learn how to choose an appropriate test and interpret its result</li>
<li>practice these tests in R</li>
<li>practice the simulation of data and error rates</li>
</ul>
<section id="a-recipe-for-hypothesis-testing" class="level2" data-number="3.1"><h2 data-number="3.1" class="anchored" data-anchor-id="a-recipe-for-hypothesis-testing">
<span class="header-section-number">3.1</span> A recipe for hypothesis testing</h2>
<p><strong>Aim:</strong> We want to know if there is a difference between the control and the treatment</p>
<ol type="1">
<li>We introduce a <strong>Null hypothesis H<sub>0</sub></strong> (e.g.&nbsp;no effect, no difference between control and treatment)</li>
<li>We invent a <strong>test statistic</strong>
</li>
<li>We calculate the <strong>expected distribution</strong> of our test statistic given H<sub>0</sub> (this is from our data-generating model)</li>
<li>We calculate the <strong>p-value</strong> = probability of getting observed test statistic or more extreme given that H<sub>0</sub> is true (there is no effect): <span class="math inline">\(p-value = P(d\ge D_{obs} | H_0)\)</span>
</li>
</ol>
<div class="callout-warning callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Interpretation of the p-value
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>p-values make a statement on the probability of the data or more extreme values given H<sub>0</sub> (no effect exists), <strong>but not on the probability of H<sub>0</sub> (no effect) and not on the size of the effect or on the probability of an effect!</strong></p>
</div>
</div>
</div>
<p><strong>Example:</strong></p>
<p>Imagine we do an experiment with two groups, one treatment and one control group. Test outcomes are binary, e.g.&nbsp;whether individuals are cured.</p>
<ol type="1">
<li><p>We need a test statistic. For example: number cured of total patients: treat/(treat+control)</p></li>
<li><p>We need the distribution of this test statistic under the null.</p></li>
</ol>
<p>Let’s create a true world without effect:</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span>
<span class="co"># Let's create a true world without effect:</span>
<span class="va">PperGroup</span> <span class="op">=</span> <span class="fl">50</span> <span class="co"># number of replicates (e.g., persons per treatment group)</span>
<span class="va">pC</span> <span class="op">=</span> <span class="fl">0.5</span> <span class="co">#probability of being cured in control group</span>
<span class="va">pT</span> <span class="op">=</span> <span class="fl">0.5</span> <span class="co">#probability of being cured in treatment group; = same because we want to use these to get the distribution of the test statistic we define below when H0 is true (no effect)</span>

<span class="co"># Let's draw a sample from this world without effect</span>
<span class="va">control</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="va">PperGroup</span>, prob <span class="op">=</span> <span class="va">pC</span><span class="op">)</span>
<span class="va">treat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="va">PperGroup</span>, prob <span class="op">=</span> <span class="va">pT</span><span class="op">)</span>
<span class="co">#calculate the test statistic: </span>
<span class="va">treat</span><span class="op">/</span><span class="op">(</span><span class="va">treat</span><span class="op">+</span><span class="va">control</span><span class="op">)</span>
<span class="co">## [1] 0.5490196</span>
<span class="co">#and plot</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">control</span>, <span class="va">treat</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">50</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="3-HypothesisTesting_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ol start="3" type="1">
<li>Now, let’s do this very often to get the distribution under H<sub>0</sub>
</li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">testStatistic</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">100000</span><span class="op">)</span> 
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100000</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">control</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="va">PperGroup</span>, prob <span class="op">=</span> <span class="va">pC</span><span class="op">)</span>
  <span class="va">treat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="va">PperGroup</span>, prob <span class="op">=</span> <span class="va">pT</span><span class="op">)</span>
  <span class="va">testStatistic</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">control</span><span class="op">/</span><span class="op">(</span><span class="va">treat</span><span class="op">+</span><span class="va">control</span><span class="op">)</span> <span class="co"># test statistic </span>
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">testStatistic</span>, breaks <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="3-HypothesisTesting_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ol start="4" type="1">
<li>We now have our test statistic + the frequency distribution of our statistic if the H<sub>0</sub> = true. Now we make an experiment: Assume that we observed the following data: C = 30, T = 23.</li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">testStatistic</span>, breaks <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>
<span class="va">testStatisticData</span> <span class="op">=</span> <span class="fl">30</span><span class="op">/</span><span class="op">(</span><span class="fl">30</span><span class="op">+</span><span class="fl">23</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="va">testStatisticData</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="3-HypothesisTesting_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R">
<span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">testStatistic</span> <span class="op">&gt;</span> <span class="va">testStatisticData</span><span class="op">)</span>
<span class="co">## [1] 0.09317</span>
<span class="co"># compare each value in our testStatistic distribution with</span>
<span class="co"># the observed value and calculate proportion of TRUE values </span>
<span class="co"># (where testStatistic &gt; testStatisticData)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>But we know actually that the test statistic follows a Chi<sup>2</sup> distribution. So to get correct p-values we can use the <code>prop.test</code> for this test statistic:</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/prop.test.html">prop.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">23</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">PperGroup</span>, <span class="va">PperGroup</span><span class="op">)</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">##  2-sample test for equality of proportions with continuity correction</span>
<span class="co">## </span>
<span class="co">## data:  c(30, 23) out of c(PperGroup, PperGroup)</span>
<span class="co">## X-squared = 1.4452, df = 1, p-value = 0.2293</span>
<span class="co">## alternative hypothesis: two.sided</span>
<span class="co">## 95 percent confidence interval:</span>
<span class="co">##  -0.0737095  0.3537095</span>
<span class="co">## sample estimates:</span>
<span class="co">## prop 1 prop 2 </span>
<span class="co">##   0.60   0.46</span>
<span class="co"># other test statistic with known distribution</span>
<span class="co"># Pearson's chi-squared test statistic</span>
<span class="co"># no need to simulate</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We pass the data to the function which first calculates the test statistic and then calculates the p-value using the Chi<sup>2</sup> distribution.</p>
</section><section id="t-test" class="level2" data-number="3.2"><h2 data-number="3.2" class="anchored" data-anchor-id="t-test">
<span class="header-section-number">3.2</span> T-test</h2>
<p>Originally developed by Wiliam Sealy Gosset (1876-1937) who has worked in the Guinness brewery. He wanted to measure which ingredients result in a better beer. The aim was to compare two beer recipes and decide whether one of the recipes was better (e.g.&nbsp;to test if it results in more alcohol). He published under the pseudonym ‘Student’ because the company considered his statistical methods as a commercial secret.</p>
<div class="callout-important callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
T-test assumptions
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>Data in both groups is normally distributed</p></li>
<li><p>H<sub>0</sub> : the means of both groups are equal</p></li>
</ul>
</div>
</div>
<p>The idea is that we have two normal distributions (e.g.&nbsp;alcohol distributions):</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
<span class="va">A</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, mean <span class="op">=</span> <span class="op">-</span><span class="fl">.3</span><span class="op">)</span>
<span class="va">B</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, mean <span class="op">=</span> <span class="fl">.3</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"red"</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.6</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="va">B</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">B</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="3-HypothesisTesting_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>And our goals is now to test if the difference between the two means of the variables is statistically significant or not.</p>
<p><strong>Procedure:</strong></p>
<ul>
<li>
<p>Calculate variances and means of both variables</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">A_m</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span>
<span class="va">B_m</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">B</span><span class="op">)</span>
<span class="va">A_v</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span>
<span class="va">B_v</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">B</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</li>
<li>
<p>Calculate t-statistic (difference between means / (Standard deviation/sample size)</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">t_statistic</span> <span class="op">=</span> <span class="op">(</span><span class="va">A_m</span> <span class="op">-</span> <span class="va">B_m</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span> <span class="va">A_v</span>  <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span> <span class="op">+</span> <span class="va">B_v</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">B</span><span class="op">)</span><span class="op">)</span>
<span class="va">t_statistic</span>
<span class="co">## [1] -3.452108</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</li>
<li>
<p>Compare observed t with t distribution under H<sub>0</sub> (which we can do by using the CDF function of the t-distribution:</p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">pt</a></span><span class="op">(</span> <span class="va">t_statistic</span>,  <span class="co"># test statistic</span>
   df <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">B</span><span class="op">)</span><span class="op">-</span><span class="fl">2</span>, <span class="co"># degrees of freedom, roughly = n_obs - n_parameters</span>
   lower.tail <span class="op">=</span> <span class="cn">TRUE</span>
  <span class="op">)</span><span class="op">*</span><span class="fl">2</span>
<span class="co">## [1] 0.0006799933</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</li>
</ul>
<div class="callout-caution callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
One-sided or two-sided
</div>
</div>
<div class="callout-body-container callout-body">
<p>If we do NOT know if the dataset from one group is larger or smaller than the other, we must use two-sided tests (that’s why we multiply the p-values with 2). Only if we are sure that the effect MUST be positive / negative, we can test for greater / less. Decide BEFORE you look at the data!</p>
</div>
</div>
<p>Let’s compare it to the output of the <code>t.test</code> function which does everything for us, we only need to pass the data to the function:</p>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">A</span>, <span class="va">B</span>, var.equal <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">##  Two Sample t-test</span>
<span class="co">## </span>
<span class="co">## data:  A and B</span>
<span class="co">## t = -3.4521, df = 198, p-value = 0.00068</span>
<span class="co">## alternative hypothesis: true difference in means is not equal to 0</span>
<span class="co">## 95 percent confidence interval:</span>
<span class="co">##  -0.7122549 -0.1943542</span>
<span class="co">## sample estimates:</span>
<span class="co">##  mean of x  mean of y </span>
<span class="co">## -0.1911126  0.2621919</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Usually we also have to test for normality of our data, which we can do with another test.</p>
<p><strong>Example airquality</strong></p>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># with real data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">PlantGrowth</span><span class="op">)</span>
<span class="co">##   weight group</span>
<span class="co">## 1   4.17  ctrl</span>
<span class="co">## 2   5.58  ctrl</span>
<span class="co">## 3   5.18  ctrl</span>
<span class="co">## 4   6.11  ctrl</span>
<span class="co">## 5   4.50  ctrl</span>
<span class="co">## 6   4.61  ctrl</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">weight</span> <span class="op">~</span> <span class="va">group</span>, data <span class="op">=</span> <span class="va">PlantGrowth</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="3-HypothesisTesting_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R">
<span class="va">ctrl</span> <span class="op">=</span> <span class="va">PlantGrowth</span><span class="op">$</span><span class="va">weight</span><span class="op">[</span><span class="va">PlantGrowth</span><span class="op">$</span><span class="va">group</span> <span class="op">==</span> <span class="st">"ctrl"</span><span class="op">]</span>
<span class="va">trt1</span> <span class="op">=</span> <span class="va">PlantGrowth</span><span class="op">$</span><span class="va">weight</span><span class="op">[</span><span class="va">PlantGrowth</span><span class="op">$</span><span class="va">group</span> <span class="op">==</span> <span class="st">"trt1"</span><span class="op">]</span>

<span class="co"># attention: t test assumes normal dirstribution of measurements in both groups!</span>
<span class="co"># test normality before doing the t test:</span>
<span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="va">ctrl</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">##  Shapiro-Wilk normality test</span>
<span class="co">## </span>
<span class="co">## data:  ctrl</span>
<span class="co">## W = 0.95668, p-value = 0.7475</span>
<span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="va">trt1</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">##  Shapiro-Wilk normality test</span>
<span class="co">## </span>
<span class="co">## data:  trt1</span>
<span class="co">## W = 0.93041, p-value = 0.4519</span>


<span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">ctrl</span>, <span class="va">trt1</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">##  Welch Two Sample t-test</span>
<span class="co">## </span>
<span class="co">## data:  ctrl and trt1</span>
<span class="co">## t = 1.1913, df = 16.524, p-value = 0.2504</span>
<span class="co">## alternative hypothesis: true difference in means is not equal to 0</span>
<span class="co">## 95 percent confidence interval:</span>
<span class="co">##  -0.2875162  1.0295162</span>
<span class="co">## sample estimates:</span>
<span class="co">## mean of x mean of y </span>
<span class="co">##     5.032     4.661</span>
<span class="co"># note that this is a "Welch" t-test</span>
<span class="co"># we will have a look at the differences among t-tests in the next large exercise</span>

<span class="co"># What is H0? equal means</span>
<span class="co"># What is the result? test is not significant, H0 is not rejected</span>
<span class="co"># Explain the different values in the output!</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout-warning callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Shapiro - Test for normality
</div>
</div>
<div class="callout-body-container callout-body">
<p>If you have a small sample size, the shapiro.test will always be non-significant (i.e.&nbsp;not significantly different from a normal distribution)! This is because small sample size leads to low power for rejecting H<sub>0</sub> of normal distribution</p>
</div>
</div>
</section><section id="type-i-error-rate" class="level2" data-number="3.3"><h2 data-number="3.3" class="anchored" data-anchor-id="type-i-error-rate">
<span class="header-section-number">3.3</span> Type I error rate</h2>
<p>Let’s start with a small simulation example:</p>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">results</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">replicate</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="op">{</span>
  <span class="va">A</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, mean <span class="op">=</span> <span class="fl">0.0</span><span class="op">)</span>
  <span class="va">B</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, mean <span class="op">=</span> <span class="fl">0.0</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">A</span>, <span class="va">B</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span>
<span class="op">}</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="3-HypothesisTesting_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>What’s happening here? We have no effect in our simulation but there are many p-values lower than <span class="math inline">\(\alpha = 0.05\)</span>:</p>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">results</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span>
<span class="co">## [1] 0.043</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>So in 0.043 of our experiments we would reject H<sub>0</sub> even when there is no effect at all! This is called the type I error rate. Those are false positives.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Type I error rate and multiple testing
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>If there is no effect, the probability of having a positive test result is equal to the significance level <span class="math inline">\(\alpha\)</span>. If you test 20 things that don’t have an effect, you will have one significant result on average when using a significance level of 0.05. If multiple tests are done, a correction for multiple testing should be used.</p>
<p>This problem is called multiple testing</p>
<ul>
<li><p>e.g.: if you try 20 different analyses (Null hypotheses), on average one of them will be significant.</p></li>
<li><p>e.g.: if you test 1000 different genes for their association with cancer, and in reality, none of them is related to cancer, 50 out of the tests will still be significant.</p></li>
<li><p>If multiple tests are done, a correction for multiple testing should be used</p></li>
<li><p>increases the p-values for each test in a way that the overall alpha level is 0.05</p></li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># conduct a t-test for each of the treatment combinations</span>
<span class="co"># save each test as a new object (test 1 to 3)</span>
<span class="va">control</span> <span class="op">=</span> <span class="va">PlantGrowth</span><span class="op">$</span><span class="va">weight</span><span class="op">[</span><span class="va">PlantGrowth</span><span class="op">$</span><span class="va">group</span> <span class="op">==</span> <span class="st">"ctrl"</span><span class="op">]</span>
<span class="va">trt1</span> <span class="op">=</span> <span class="va">PlantGrowth</span><span class="op">$</span><span class="va">weight</span><span class="op">[</span><span class="va">PlantGrowth</span><span class="op">$</span><span class="va">group</span> <span class="op">==</span> <span class="st">"trt1"</span><span class="op">]</span>
<span class="va">trt2</span> <span class="op">=</span> <span class="va">PlantGrowth</span><span class="op">$</span><span class="va">weight</span><span class="op">[</span><span class="va">PlantGrowth</span><span class="op">$</span><span class="va">group</span> <span class="op">==</span> <span class="st">"trt2"</span><span class="op">]</span>

<span class="va">test1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">control</span>, <span class="va">trt1</span><span class="op">)</span>
<span class="va">test2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">control</span>, <span class="va">trt2</span><span class="op">)</span>
<span class="va">test3</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">trt1</span>, <span class="va">trt2</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">test1</span><span class="op">$</span><span class="va">p.value</span>, <span class="va">test2</span><span class="op">$</span><span class="va">p.value</span>, <span class="va">test3</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span>
<span class="co">## [1] 0.250382509 0.047899256 0.009298405</span>

<span class="co"># now adjust these values</span>
<span class="fu"><a href="https://rdrr.io/r/stats/p.adjust.html">p.adjust</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">test1</span><span class="op">$</span><span class="va">p.value</span>, <span class="va">test2</span><span class="op">$</span><span class="va">p.value</span>, <span class="va">test3</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span> <span class="co"># standard is holm, average conservative</span>
<span class="co">## [1] 0.25038251 0.09579851 0.02789521</span>
<span class="fu"><a href="https://rdrr.io/r/stats/p.adjust.html">p.adjust</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">test1</span><span class="op">$</span><span class="va">p.value</span>, <span class="va">test2</span><span class="op">$</span><span class="va">p.value</span>, <span class="va">test3</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"bonferroni"</span><span class="op">)</span> <span class="co"># conservative</span>
<span class="co">## [1] 0.75114753 0.14369777 0.02789521</span>
<span class="fu"><a href="https://rdrr.io/r/stats/p.adjust.html">p.adjust</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">test1</span><span class="op">$</span><span class="va">p.value</span>, <span class="va">test2</span><span class="op">$</span><span class="va">p.value</span>, <span class="va">test3</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"BH"</span><span class="op">)</span> <span class="co"># least conservative</span>
<span class="co">## [1] 0.25038251 0.07184888 0.02789521</span>
<span class="co"># for details on the methods see help</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>If multiple testing is a problem and if we want to avoid false positives (type I errors), why don’t we use a smaller alpha level? Because if would increase the type II error rate</p>
</section><section id="type-ii-error-rate" class="level2" data-number="3.4"><h2 data-number="3.4" class="anchored" data-anchor-id="type-ii-error-rate">
<span class="header-section-number">3.4</span> Type II error rate</h2>
<p>It can also happen the other way around:</p>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">results</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">replicate</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="op">{</span>
  <span class="va">A</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, mean <span class="op">=</span> <span class="fl">0.0</span><span class="op">)</span>
  <span class="va">B</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, mean <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="co"># effect is there</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">A</span>, <span class="va">B</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span>
<span class="op">}</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="3-HypothesisTesting_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">results</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span>
<span class="co">## [1] 0.292</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>No we wouldn’t reject the H<sub>0</sub> in 0.708% of our experiments. This is the type II error rate (false negatives).</p>
<p>The type II error rate (<span class="math inline">\(\beta\)</span>) is affected by</p>
<ul>
<li>sample size <span class="math inline">\(\uparrow\)</span> , decreases <span class="math inline">\(\beta\)</span>
</li>
<li>true effect size <span class="math inline">\(\uparrow\)</span>, decreases <span class="math inline">\(\beta\)</span>
</li>
<li>
<span class="math inline">\(\alpha\)</span> <span class="math inline">\(\uparrow\)</span>, decreases <span class="math inline">\(\beta\)</span>
</li>
<li>variability (variance) <span class="math inline">\(\uparrow\)</span>, increases <span class="math inline">\(\beta\)</span>
</li>
</ul>
<p>After the experiment, the only parameter we could change would be the significance level <span class="math inline">\(\alpha\)</span>, but increasing it would result in too high Type I error rates.</p>
</section><section id="statistical-power" class="level2" data-number="3.5"><h2 data-number="3.5" class="anchored" data-anchor-id="statistical-power">
<span class="header-section-number">3.5</span> Statistical power</h2>
<p>We can reduce <span class="math inline">\(\alpha\)</span> and we will get fewer type I errors (false positives), but type II errors (false negatives) will increase. So what can we do with this in practice?</p>
<p>1- <span class="math inline">\(\beta\)</span> is the so called statistical power which is the rate at which a test is significant if the effect truly exists. Power increases with stronger effect, smaller variability, (larget <span class="math inline">\(\alpha\)</span> ), and more data (sample size). So, collect more data? How much data do we need?</p>
<p>Before the experiment, you can estimate the effect size and the variability. Together with alpha (known), you can calculate the power depending on the sample size:</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">results</span> <span class="op">=</span> 
  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">500</span>, by <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">results</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">replicate</a></span><span class="op">(</span><span class="fl">100</span>, <span class="op">{</span>
      <span class="va">A</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span>, mean <span class="op">=</span> <span class="fl">0.0</span><span class="op">)</span>
      <span class="va">B</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span>, mean <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="co"># effect is there</span>
      <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">A</span>, <span class="va">B</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span>
    <span class="op">}</span><span class="op">)</span>
    <span class="va">power</span> <span class="op">=</span> <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">results</span> <span class="op">&gt;</span> <span class="fl">0.05</span><span class="op">)</span>
    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">power</span><span class="op">)</span>
  <span class="op">}</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">500</span>, by <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>, <span class="va">results</span>, xlab <span class="op">=</span> <span class="st">"Sample size"</span>, ylab <span class="op">=</span> <span class="st">"Power"</span>, main <span class="op">=</span> <span class="st">""</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="3-HypothesisTesting_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We call that a power analysis and there’s a function in R to do that:</p>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/power.t.test.html">power.t.test</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span>, delta <span class="op">=</span> <span class="fl">1</span>, sd <span class="op">=</span> <span class="fl">1</span>, type <span class="op">=</span> <span class="st">"one.sample"</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">##      One-sample t test power calculation </span>
<span class="co">## </span>
<span class="co">##               n = 10</span>
<span class="co">##           delta = 1</span>
<span class="co">##              sd = 1</span>
<span class="co">##       sig.level = 0.05</span>
<span class="co">##           power = 0.8030962</span>
<span class="co">##     alternative = two.sided</span>

<span class="co"># Power increases with sample size (effect size constant, sd constant):</span>
<span class="va">pow</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/power.t.test.html">power.t.test</a></span><span class="op">(</span><span class="va">n</span>, delta <span class="op">=</span> <span class="fl">1</span>, sd <span class="op">=</span> <span class="fl">1</span>, type <span class="op">=</span> <span class="st">"one.sample"</span><span class="op">)</span><span class="op">$</span><span class="va">power</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>, <span class="va">pow</span><span class="op">)</span>, xlab <span class="op">=</span> <span class="st">"Sample size"</span>, ylab <span class="op">=</span> <span class="st">"Power"</span>, pch <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="3-HypothesisTesting_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R">
<span class="co"># Power increases with effect size</span>
<span class="va">pow</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">d</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/power.t.test.html">power.t.test</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">20</span>, delta <span class="op">=</span> <span class="va">d</span>, sd <span class="op">=</span> <span class="fl">1</span>, 
                                type <span class="op">=</span> <span class="st">"one.sample"</span><span class="op">)</span><span class="op">$</span><span class="va">power</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0.05</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0.05</span><span class="op">)</span>, <span class="va">pow</span><span class="op">)</span>, xlab <span class="op">=</span> <span class="st">"Effect size"</span>, 
     ylab <span class="op">=</span> <span class="st">"Power"</span>, pch <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="3-HypothesisTesting_files/figure-html/unnamed-chunk-18-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R">
<span class="co"># Power decreases with increasing standard deviation (or variance):</span>
<span class="va">pow</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">s</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/power.t.test.html">power.t.test</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">20</span>, delta <span class="op">=</span> <span class="fl">1</span>, sd <span class="op">=</span> <span class="va">s</span>, 
                                type <span class="op">=</span> <span class="st">"one.sample"</span><span class="op">)</span><span class="op">$</span><span class="va">power</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">1.5</span>,<span class="fl">0.05</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">1.5</span>,<span class="fl">0.05</span><span class="op">)</span>, <span class="va">pow</span><span class="op">)</span>, 
     xlab <span class="op">=</span> <span class="st">"Standard deviation"</span>, ylab <span class="op">=</span> <span class="st">"Power"</span>, pch <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="3-HypothesisTesting_files/figure-html/unnamed-chunk-18-3.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="false-discovery-rate" class="level2" data-number="3.6"><h2 data-number="3.6" class="anchored" data-anchor-id="false-discovery-rate">
<span class="header-section-number">3.6</span> False discovery rate</h2>
<p>You may have realized that if we do an experiment with a (weak) effect, we can get a significant result because of the effect but also significant results because of the Type I error rate. How to distinguish between those two? How can we decide whether a significant result is a false positive? This error rate is called the false discovery rate and to lower it we need to increase the power:</p>
<p><span class="math display">\[
FDR = \frac{p(H_0)\cdot\alpha}{p(H_0)\cdot\alpha + p(!H_0)\cdot(1-\beta)}
\]</span></p>
<p><span class="math inline">\(p(H_0)\)</span> = probability of H<sub>0</sub> (no effect); <span class="math inline">\(p(!H_0)\)</span> = probability of not H<sub>0</sub> (effect exists). Both are unknown and the only parameters we can influence is <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> . But decreasing <span class="math inline">\(\alpha\)</span> leads to too high false negatives, so <span class="math inline">\(\beta\)</span> is left.</p>
</section><section id="statistical-tests" class="level2" data-number="3.7"><h2 data-number="3.7" class="anchored" data-anchor-id="statistical-tests">
<span class="header-section-number">3.7</span> Statistical tests</h2>
<p>The following three sections provide an overview over the most important hypothesis tests, a guideline to select an appropriate test (see decision tree) and the necessary code to apply these tests in R. It is not necessary to read and understand every detail. These explanations are also meant as an advice if you want to select an appropriate hypothesis test after the course. Note that some of the examples use simulated data instead of real observation (all functions that start with r=random, e.g.&nbsp;rnorm() or runif()). Simulated data is useful, because then we know the true distribution and its true mean.</p>
<p>In the last section at the end of this file, you find exercises that you should solve using the explanations above. It may be helpful to use the table of content and/or the search option to find the respective example in the explanations.</p>
</section><section id="comparison-of-mean-of-two-or-more-groups" class="level2" data-number="3.8"><h2 data-number="3.8" class="anchored" data-anchor-id="comparison-of-mean-of-two-or-more-groups">
<span class="header-section-number">3.8</span> Comparison of mean of two or more groups</h2>
<p>Many tests aim at showing that variables are significantly different between groups, i.e.&nbsp;have different means/medians. In all these tests, H<sub>0</sub> is that there is no difference between the groups. The following decision tree helps to select the appropriate test.</p>
<!-- ![Fig. 1. Decision tree for the comparison of two groups](Decision%20tree.jpg) -->
<p><strong>Remark 1</strong>: Tests for 2 groups also work for one group only. Then they test whether the mean is equal to 0.</p>
<p><strong>Remark 2</strong>: Paired / unpaired: this means that observations in the groups are linked to each other. An example for unpaired data is a typical experiment with 10 observations in the control group and 10 observations in the treatment group. An example for paired data is when the same individuals were exposed to the treatment and to the control. The observations of each individual would belong together (pairs).</p>
<p><strong>Remark 3</strong>: Parametric: assumption of normal distribution. Non-parametric = no assumption for the distribution.</p>
<p><strong>Remark 4</strong>: Blue text: If a test for more than two groups is significant, post-hoc tests are carried out in a second step. These check all possible comparisons of groups for significant differences by adjusting p-values for multiple testing.</p>
<section id="tests-for-2-groups" class="level3" data-number="3.8.1"><h3 data-number="3.8.1" class="anchored" data-anchor-id="tests-for-2-groups">
<span class="header-section-number">3.8.1</span> Tests for 2 groups</h3>
<section id="t-test-1" class="level4" data-number="3.8.1.1"><h4 data-number="3.8.1.1" class="anchored" data-anchor-id="t-test-1">
<span class="header-section-number">3.8.1.1</span> t-Test</h4>
<p>The t-test can draw conclusions about the mean(s) of 1 or 2 normally-distributed groups.</p>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">## Classical example: Student's sleep data</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">extra</span> <span class="op">~</span> <span class="va">group</span>, data <span class="op">=</span> <span class="va">sleep</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="3-HypothesisTesting_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Be aware</strong>: The line in the box plot does not show the mean but the median.</p>
<div class="cell">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">## Formula interface</span>
<span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">extra</span> <span class="op">~</span> <span class="va">group</span>, data <span class="op">=</span> <span class="va">sleep</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">##  Welch Two Sample t-test</span>
<span class="co">## </span>
<span class="co">## data:  extra by group</span>
<span class="co">## t = -1.8608, df = 17.776, p-value = 0.07939</span>
<span class="co">## alternative hypothesis: true difference in means between group 1 and group 2 is not equal to 0</span>
<span class="co">## 95 percent confidence interval:</span>
<span class="co">##  -3.3654832  0.2054832</span>
<span class="co">## sample estimates:</span>
<span class="co">## mean in group 1 mean in group 2 </span>
<span class="co">##            0.75            2.33</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This output tells us, that the difference in means between the 2 groups is not significant(p-value ≥ 0.05, specifically: p-value = 0.07939), provided that our significance level is 0.05.<br>
The underlying Null-hypothesis is that the true difference in means is equal to 0. In the last two lines of the output you can see the means of the respective groups. Even though the means seem to be quite different, the difference is not significant, this could be due to the small sample size of only 10 students per group.</p>
<p>Let’s look at different settings of the t-test:</p>
<section id="t-test-h0-one-group-mean-0" class="level5" data-number="3.8.1.1.1"><h5 data-number="3.8.1.1.1" class="anchored" data-anchor-id="t-test-h0-one-group-mean-0">
<span class="header-section-number">3.8.1.1.1</span> t-test, H0: one group, mean = 0</h5>
<p>The Null-hypothesis here is that the mean of the observed group is equal to 0.</p>
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">20</span>, mean <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">##  One Sample t-test</span>
<span class="co">## </span>
<span class="co">## data:  x</span>
<span class="co">## t = 11.224, df = 19, p-value = 7.944e-10</span>
<span class="co">## alternative hypothesis: true mean is not equal to 0</span>
<span class="co">## 95 percent confidence interval:</span>
<span class="co">##  1.786080 2.604892</span>
<span class="co">## sample estimates:</span>
<span class="co">## mean of x </span>
<span class="co">##  2.195486</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>p-value &lt; 0.05 means we can reject the Null-hypothesis, i.e.&nbsp;the mean of the observed group is significantly different from 0.</p>
</section><section id="t-test-h0-two-groups-equal-means-equal-variances" class="level5" data-number="3.8.1.1.2"><h5 data-number="3.8.1.1.2" class="anchored" data-anchor-id="t-test-h0-two-groups-equal-means-equal-variances">
<span class="header-section-number">3.8.1.1.2</span> t-test, H0: two groups, equal means, equal variances</h5>
<p>The Null-hypothesis here is that the two observed groups have the same mean and the same variance (specified by the argument <em>var.equal = T</em>).</p>
<div class="cell">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">x1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">20</span>, mean <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">x2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">20</span>, mean <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">x1</span>,<span class="va">x2</span>, var.equal <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">##  Two Sample t-test</span>
<span class="co">## </span>
<span class="co">## data:  x1 and x2</span>
<span class="co">## t = -3.1484, df = 38, p-value = 0.00319</span>
<span class="co">## alternative hypothesis: true difference in means is not equal to 0</span>
<span class="co">## 95 percent confidence interval:</span>
<span class="co">##  -1.6632472 -0.3614177</span>
<span class="co">## sample estimates:</span>
<span class="co">## mean of x mean of y </span>
<span class="co">##  2.074797  3.087130</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="t-test-h0-two-groups-equal-means-variable-variance" class="level5" data-number="3.8.1.1.3"><h5 data-number="3.8.1.1.3" class="anchored" data-anchor-id="t-test-h0-two-groups-equal-means-variable-variance">
<span class="header-section-number">3.8.1.1.3</span> t-test, H0: two groups, equal means, variable variance</h5>
<p>The Null-hypothesis here is that the two observed groups have the same mean and variable variances (the default setting of the argument <em>var.equal = F</em>).</p>
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">x1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">20</span>, mean <span class="op">=</span> <span class="fl">2</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="va">x2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">20</span>, mean <span class="op">=</span> <span class="fl">3</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">x1</span>,<span class="va">x2</span>, var.equal <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">##  Welch Two Sample t-test</span>
<span class="co">## </span>
<span class="co">## data:  x1 and x2</span>
<span class="co">## t = -2.1475, df = 30.4, p-value = 0.03984</span>
<span class="co">## alternative hypothesis: true difference in means is not equal to 0</span>
<span class="co">## 95 percent confidence interval:</span>
<span class="co">##  -1.9210146 -0.0487896</span>
<span class="co">## sample estimates:</span>
<span class="co">## mean of x mean of y </span>
<span class="co">##  1.930744  2.915646</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Which is actually a Welch t-test and which is the default in R! (The smaller the samples, the more likely it is that the variances differ! So it is an conservative assumption to assume that the variances are unequal)</p>
</section><section id="t-test-h0-two-groups-paired-equal-means-variance-can-be-different" class="level5" data-number="3.8.1.1.4"><h5 data-number="3.8.1.1.4" class="anchored" data-anchor-id="t-test-h0-two-groups-paired-equal-means-variance-can-be-different">
<span class="header-section-number">3.8.1.1.4</span> t-test, H0: two groups, paired, equal means, variance can be different</h5>
<p>The Null-hypothesis here is that the two groups are paired observations (e.g.&nbsp;group 1 before treatment and group 2 after treatment) have the same mean. Variances doesn’t matter here (but the variables must be still normally distributed). We can ignore the <code>var.equal</code>`argument here:</p>
<div class="cell">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">x1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">20</span>, mean <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">x2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">20</span>, mean <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">x1</span>,<span class="va">x2</span>, paired <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">##  Paired t-test</span>
<span class="co">## </span>
<span class="co">## data:  x1 and x2</span>
<span class="co">## t = -5.5876, df = 19, p-value = 2.177e-05</span>
<span class="co">## alternative hypothesis: true mean difference is not equal to 0</span>
<span class="co">## 95 percent confidence interval:</span>
<span class="co">##  -2.222268 -1.011105</span>
<span class="co">## sample estimates:</span>
<span class="co">## mean difference </span>
<span class="co">##       -1.616686</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If the variables are not normally distributed we have to use non-parametric tests which don’t assume a certain assumption regarding the distribution of the variables (=nonparametric). But the test statistic still follows a certain distribution!</p>
</section></section><section id="wilcoxon-rank-sum-and-mann-whitney-u-test" class="level4" data-number="3.8.1.2"><h4 data-number="3.8.1.2" class="anchored" data-anchor-id="wilcoxon-rank-sum-and-mann-whitney-u-test">
<span class="header-section-number">3.8.1.2</span> Wilcoxon Rank Sum and Mann-Whitney U Test</h4>
<p>In R, there is only one function for both tests together: wilcox.test(). The Wilcoxon rank sum test with (paired = F) is classically called Mann-Whitney U test.</p>
<section id="unpaired-mann-whitney-u-test" class="level5" data-number="3.8.1.2.1"><h5 data-number="3.8.1.2.1" class="anchored" data-anchor-id="unpaired-mann-whitney-u-test">
<span class="header-section-number">3.8.1.2.1</span> Unpaired: Mann-Whitney U Test</h5>
<div class="cell">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">x1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">20</span>, mean <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">x2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html">rlnorm</a></span><span class="op">(</span><span class="fl">20</span>, mean <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/stats/wilcox.test.html">wilcox.test</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">##  Wilcoxon rank sum exact test</span>
<span class="co">## </span>
<span class="co">## data:  x1 and x2</span>
<span class="co">## W = 18, p-value = 2.317e-08</span>
<span class="co">## alternative hypothesis: true location shift is not equal to 0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="paired-wilcoxon-signed-rank-test" class="level5" data-number="3.8.1.2.2"><h5 data-number="3.8.1.2.2" class="anchored" data-anchor-id="paired-wilcoxon-signed-rank-test">
<span class="header-section-number">3.8.1.2.2</span> Paired: Wilcoxon signed rank test</h5>
<div class="cell">
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">x1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">20</span>, mean <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">x2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html">rlnorm</a></span><span class="op">(</span><span class="fl">20</span>, mean <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/stats/wilcox.test.html">wilcox.test</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span>, paired <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">##  Wilcoxon signed rank exact test</span>
<span class="co">## </span>
<span class="co">## data:  x1 and x2</span>
<span class="co">## V = 0, p-value = 1.907e-06</span>
<span class="co">## alternative hypothesis: true location shift is not equal to 0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section></section><section id="tests-for-2-groups-1" class="level3" data-number="3.8.2"><h3 data-number="3.8.2" class="anchored" data-anchor-id="tests-for-2-groups-1">
<span class="header-section-number">3.8.2</span> Tests for &gt; 2 groups</h3>
<section id="anova-unpaired" class="level4" data-number="3.8.2.1"><h4 data-number="3.8.2.1" class="anchored" data-anchor-id="anova-unpaired">
<span class="header-section-number">3.8.2.1</span> Anova, unpaired</h4>
<p><strong>H0 &gt;2 groups, normal distribution, equal variance, equal means, unpaired</strong></p>
<div class="cell">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">weight</span> <span class="op">~</span> <span class="va">group</span>, data <span class="op">=</span> <span class="va">PlantGrowth</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="co">##             Df Sum Sq Mean Sq F value Pr(&gt;F)  </span>
<span class="co">## group        2  3.766  1.8832   4.846 0.0159 *</span>
<span class="co">## Residuals   27 10.492  0.3886                 </span>
<span class="co">## ---</span>
<span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>An ANOVA only tests, if there is a difference, but not between which groups. To perform pairwise comparisons, you can use post-hoc tests. Common for ANOVA results is</p>
<div class="cell">
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/TukeyHSD.html">TukeyHSD</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="co">##   Tukey multiple comparisons of means</span>
<span class="co">##     95% family-wise confidence level</span>
<span class="co">## </span>
<span class="co">## Fit: aov(formula = weight ~ group, data = PlantGrowth)</span>
<span class="co">## </span>
<span class="co">## $group</span>
<span class="co">##             diff        lwr       upr     p adj</span>
<span class="co">## trt1-ctrl -0.371 -1.0622161 0.3202161 0.3908711</span>
<span class="co">## trt2-ctrl  0.494 -0.1972161 1.1852161 0.1979960</span>
<span class="co">## trt2-trt1  0.865  0.1737839 1.5562161 0.0120064</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Alternatively, you can also perform several tests each comparing two groups and then correct for multiple testing. This is what we did before.</p>
<p>Pairwise comparisons are often visualized using different letters to significantly different groups:</p>
<div class="cell">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># install.packages("multcomp")</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://multcomp.R-forge.R-project.org">multcomp</a></span><span class="op">)</span>
<span class="va">tuk</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/multcomp/man/glht.html">glht</a></span><span class="op">(</span><span class="va">x</span>, linfct <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/multcomp/man/glht.html">mcp</a></span><span class="op">(</span>group <span class="op">=</span> <span class="st">"Tukey"</span><span class="op">)</span><span class="op">)</span> <span class="co">#performs Tukey pairwise comparisons</span>
<span class="va">tuc.cld</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/multcomp/man/cld.html">cld</a></span><span class="op">(</span><span class="va">tuk</span><span class="op">)</span> <span class="co"># assigns different letters to significantly different groups</span>

<span class="va">old.par</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mai <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1.25</span>, <span class="fl">1</span><span class="op">)</span>, no.readonly <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">tuc.cld</span><span class="op">)</span> <span class="co"># draws boxplot + letters from cld function</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="3-HypothesisTesting_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="va">old.par</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="anova-paired" class="level4" data-number="3.8.2.2"><h4 data-number="3.8.2.2" class="anchored" data-anchor-id="anova-paired">
<span class="header-section-number">3.8.2.2</span> Anova, paired</h4>
<p>aov is not good in doing repeated = paired ANOVA. In simple cases, you can just subtract the paired groups. In general, you should use so-called mixed models!</p>
</section><section id="kruskal-wallis-unpaired-non-parametric" class="level4" data-number="3.8.2.3"><h4 data-number="3.8.2.3" class="anchored" data-anchor-id="kruskal-wallis-unpaired-non-parametric">
<span class="header-section-number">3.8.2.3</span> Kruskal-Wallis, unpaired non-parametric</h4>
<p>Non-parametric test for differences in the mean of &gt;2 groups, unpaired</p>
<div class="cell">
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">Ozone</span> <span class="op">~</span> <span class="va">Month</span>, data <span class="op">=</span> <span class="va">airquality</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="3-HypothesisTesting_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/kruskal.test.html">kruskal.test</a></span><span class="op">(</span><span class="va">Ozone</span> <span class="op">~</span> <span class="va">Month</span>, data <span class="op">=</span> <span class="va">airquality</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">##  Kruskal-Wallis rank sum test</span>
<span class="co">## </span>
<span class="co">## data:  Ozone by Month</span>
<span class="co">## Kruskal-Wallis chi-squared = 29.267, df = 4, p-value = 6.901e-06</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="friedmann-test-paired-non-parametric" class="level4" data-number="3.8.2.4"><h4 data-number="3.8.2.4" class="anchored" data-anchor-id="friedmann-test-paired-non-parametric">
<span class="header-section-number">3.8.2.4</span> Friedmann Test, paired non-parametric</h4>
<p>Non-parametric test for differences in the mean of &gt;2 groups, paired.</p>
<div class="cell">
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">wb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html">aggregate</a></span><span class="op">(</span><span class="va">warpbreaks</span><span class="op">$</span><span class="va">breaks</span>,
                by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>w <span class="op">=</span> <span class="va">warpbreaks</span><span class="op">$</span><span class="va">wool</span>,
                          t <span class="op">=</span> <span class="va">warpbreaks</span><span class="op">$</span><span class="va">tension</span><span class="op">)</span>,
                FUN <span class="op">=</span> <span class="va">mean</span><span class="op">)</span>
<span class="co">#wb</span>
<span class="fu"><a href="https://rdrr.io/r/stats/friedman.test.html">friedman.test</a></span><span class="op">(</span><span class="va">wb</span><span class="op">$</span><span class="va">x</span>, <span class="va">wb</span><span class="op">$</span><span class="va">w</span>, <span class="va">wb</span><span class="op">$</span><span class="va">t</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">##  Friedman rank sum test</span>
<span class="co">## </span>
<span class="co">## data:  wb$x, wb$w and wb$t</span>
<span class="co">## Friedman chi-squared = 0.33333, df = 1, p-value = 0.5637</span>
<span class="co"># Alternative: friedman.test(x ~ w | t, data = wb)</span>
<span class="co"># Note that x is the response, w is the group, and t are the blocks that are paired</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section></section><section id="comparison-of-variances" class="level2" data-number="3.9"><h2 data-number="3.9" class="anchored" data-anchor-id="comparison-of-variances">
<span class="header-section-number">3.9</span> Comparison of variances</h2>
<p>H<sub>0</sub> in variance tests is always that the variances are equal.</p>
<section id="f-test-for-two-normally-distributed-samples" class="level3" data-number="3.9.1"><h3 data-number="3.9.1" class="anchored" data-anchor-id="f-test-for-two-normally-distributed-samples">
<span class="header-section-number">3.9.1</span> F-Test for two normally-distributed samples</h3>
<div class="cell">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">50</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">30</span>, mean <span class="op">=</span> <span class="fl">1</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/var.test.html">var.test</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span>                  <span class="co"># Do x and y have the same variance? - Significantly different</span>
<span class="co">## </span>
<span class="co">##  F test to compare two variances</span>
<span class="co">## </span>
<span class="co">## data:  x and y</span>
<span class="co">## F = 6.1781, num df = 49, denom df = 29, p-value = 1.518e-06</span>
<span class="co">## alternative hypothesis: true ratio of variances is not equal to 1</span>
<span class="co">## 95 percent confidence interval:</span>
<span class="co">##   3.10401 11.62354</span>
<span class="co">## sample estimates:</span>
<span class="co">## ratio of variances </span>
<span class="co">##           6.178079</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="bartlett-test-for-more-than-two-normally-distributed-samples" class="level3" data-number="3.9.2"><h3 data-number="3.9.2" class="anchored" data-anchor-id="bartlett-test-for-more-than-two-normally-distributed-samples">
<span class="header-section-number">3.9.2</span> Bartlett test for more than two normally-distributed samples</h3>
<div class="cell">
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">50</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">30</span>, mean <span class="op">=</span> <span class="fl">1</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">30</span>, mean <span class="op">=</span> <span class="fl">1</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/bartlett.test.html">bartlett.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">z</span><span class="op">)</span><span class="op">)</span>                <span class="co"># Do x, y and z have the same variance? - Not sigificantly different</span>
<span class="co">## </span>
<span class="co">##  Bartlett test of homogeneity of variances</span>
<span class="co">## </span>
<span class="co">## data:  list(x, y, z)</span>
<span class="co">## Bartlett's K-squared = 11.622, df = 2, p-value = 0.002994</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="comparison-of-discrete-proportions" class="level2" data-number="3.10"><h2 data-number="3.10" class="anchored" data-anchor-id="comparison-of-discrete-proportions">
<span class="header-section-number">3.10</span> Comparison of discrete proportions</h2>
<p>Discrete proportions are typically analyzed assuming the binomial model (k/n with probability p)</p>
<section id="exact-binomial-test" class="level3" data-number="3.10.1"><h3 data-number="3.10.1" class="anchored" data-anchor-id="exact-binomial-test">
<span class="header-section-number">3.10.1</span> Exact Binomial Test</h3>
<p>H0 is that the data are binomially distributed with a fixed probability p.</p>
<div class="cell">
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">## Conover (1971), p. 97f.</span>
<span class="co">## Under (the assumption of) simple Mendelian inheritance, a cross</span>
<span class="co">##  between plants of two particular genotypes produces progeny 1/4 of</span>
<span class="co">##  which are "dwarf" and 3/4 of which are "giant", respectively.</span>
<span class="co">##  In an experiment to determine if this assumption is reasonable, a</span>
<span class="co">##  cross results in progeny having 243 dwarf and 682 giant plants.</span>
<span class="co">##  If "giant" is taken as success, the null hypothesis is that p =</span>
<span class="co">##  3/4 and the alternative that p != 3/4.</span>
<span class="fu"><a href="https://rdrr.io/r/stats/binom.test.html">binom.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">682</span>, <span class="fl">243</span><span class="op">)</span>, p <span class="op">=</span> <span class="fl">3</span><span class="op">/</span><span class="fl">4</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">##  Exact binomial test</span>
<span class="co">## </span>
<span class="co">## data:  c(682, 243)</span>
<span class="co">## number of successes = 682, number of trials = 925, p-value = 0.3825</span>
<span class="co">## alternative hypothesis: true probability of success is not equal to 0.75</span>
<span class="co">## 95 percent confidence interval:</span>
<span class="co">##  0.7076683 0.7654066</span>
<span class="co">## sample estimates:</span>
<span class="co">## probability of success </span>
<span class="co">##              0.7372973</span>
<span class="fu"><a href="https://rdrr.io/r/stats/binom.test.html">binom.test</a></span><span class="op">(</span><span class="fl">682</span>, <span class="fl">682</span> <span class="op">+</span> <span class="fl">243</span>, p <span class="op">=</span> <span class="fl">3</span><span class="op">/</span><span class="fl">4</span><span class="op">)</span>   <span class="co"># The same.</span>
<span class="co">## </span>
<span class="co">##  Exact binomial test</span>
<span class="co">## </span>
<span class="co">## data:  682 and 682 + 243</span>
<span class="co">## number of successes = 682, number of trials = 925, p-value = 0.3825</span>
<span class="co">## alternative hypothesis: true probability of success is not equal to 0.75</span>
<span class="co">## 95 percent confidence interval:</span>
<span class="co">##  0.7076683 0.7654066</span>
<span class="co">## sample estimates:</span>
<span class="co">## probability of success </span>
<span class="co">##              0.7372973</span>
<span class="co">## =&gt; Data are in agreement with H0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="test-of-equal-or-given-proportions" class="level3" data-number="3.10.2"><h3 data-number="3.10.2" class="anchored" data-anchor-id="test-of-equal-or-given-proportions">
<span class="header-section-number">3.10.2</span> Test of Equal or Given Proportions</h3>
<p>based on Chi-squared-test, H0 is that the data in two groups are binomially distributed with the same probability p.</p>
<div class="cell">
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">## Data from Fleiss (1981), p. 139.</span>
<span class="co">## H0: The null hypothesis is that the four populations from which</span>
<span class="co">##     the patients were drawn have the same true proportion of smokers.</span>
<span class="co">## A:  The alternative is that this proportion is different in at</span>
<span class="co">##     least one of the populations.</span>
<span class="va">smokers</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span> <span class="fl">83</span>, <span class="fl">90</span>, <span class="fl">129</span>, <span class="fl">70</span> <span class="op">)</span>
<span class="va">patients</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span> <span class="fl">86</span>, <span class="fl">93</span>, <span class="fl">136</span>, <span class="fl">82</span> <span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/prop.test.html">prop.test</a></span><span class="op">(</span><span class="va">smokers</span>, <span class="va">patients</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">##  4-sample test for equality of proportions without continuity correction</span>
<span class="co">## </span>
<span class="co">## data:  smokers out of patients</span>
<span class="co">## X-squared = 12.6, df = 3, p-value = 0.005585</span>
<span class="co">## alternative hypothesis: two.sided</span>
<span class="co">## sample estimates:</span>
<span class="co">##    prop 1    prop 2    prop 3    prop 4 </span>
<span class="co">## 0.9651163 0.9677419 0.9485294 0.8536585</span>
<span class="co">##  =&gt; Data are not in agreement with H0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="contingency-tables" class="level3" data-number="3.10.3"><h3 data-number="3.10.3" class="anchored" data-anchor-id="contingency-tables">
<span class="header-section-number">3.10.3</span> Contingency tables</h3>
<p>Chi-squared-test for count data, H~0~ is that the joint distribution of the cell counts in a 2-dimensional contingency table is the product of the row and column marginals</p>
<div class="cell">
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co">## From Agresti(2007) p.39</span>
<span class="va">M</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">as.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">762</span>, <span class="fl">327</span>, <span class="fl">468</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">484</span>, <span class="fl">239</span>, <span class="fl">477</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/dimnames.html">dimnames</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>gender <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"F"</span>, <span class="st">"M"</span><span class="op">)</span>,
                    party <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Democrat"</span>,<span class="st">"Independent"</span>, <span class="st">"Republican"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/chisq.test.html">chisq.test</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">##  Pearson's Chi-squared test</span>
<span class="co">## </span>
<span class="co">## data:  M</span>
<span class="co">## X-squared = 30.07, df = 2, p-value = 2.954e-07</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="distribution-tests" class="level2" data-number="3.11"><h2 data-number="3.11" class="anchored" data-anchor-id="distribution-tests">
<span class="header-section-number">3.11</span> Distribution tests</h2>
<p>Often we are interested in the distribution of a variable. This can be tested with distribution tests. All these tests are defined as follows: H<sub>0</sub> is that the data follow a specific distribution. So in case H<sub>0</sub> is rejected, the data significantly deviates from the specified distribution.</p>
<p>Often, we want to know whether a variable is normally distributed because this is an important assumption for parametric hypothesis tests. But data can follow many other distributions:</p>
<!-- ![Fig. 2. Decision tree for distributions](distributions.png) -->
<section id="shapiro-wilk-normality-test" class="level3" data-number="3.11.1"><h3 data-number="3.11.1" class="anchored" data-anchor-id="shapiro-wilk-normality-test">
<span class="header-section-number">3.11.1</span> Shapiro-Wilk Normality Test</h3>
<p>Because many tests require normal distribution, this is the test needed most often.</p>
<div class="cell">
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, mean <span class="op">=</span> <span class="fl">5</span>, sd <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">##  Shapiro-Wilk normality test</span>
<span class="co">## </span>
<span class="co">## data:  rnorm(100, mean = 5, sd = 3)</span>
<span class="co">## W = 0.97832, p-value = 0.09833</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="kolmogorov-smirnov-test" class="level3" data-number="3.11.2"><h3 data-number="3.11.2" class="anchored" data-anchor-id="kolmogorov-smirnov-test">
<span class="header-section-number">3.11.2</span> Kolmogorov-Smirnov Test</h3>
<p>For everything else, the KS test can be used. It compares two different distributions, or a distribution against a reference.</p>
<div class="cell">
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">50</span><span class="op">)</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">30</span><span class="op">)</span>
<span class="co"># Do x and y come from the same distribution?</span>
<span class="fu"><a href="https://rdrr.io/r/stats/ks.test.html">ks.test</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">##  Exact two-sample Kolmogorov-Smirnov test</span>
<span class="co">## </span>
<span class="co">## data:  x and y</span>
<span class="co">## D = 0.54, p-value = 1.598e-05</span>
<span class="co">## alternative hypothesis: two-sided</span>

<span class="co"># Does x come from a shifted gamma distribution with shape 3 and rate 2?</span>
<span class="fu"><a href="https://rdrr.io/r/stats/ks.test.html">ks.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">+</span><span class="fl">2</span>, <span class="st">"pgamma"</span>, <span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span> <span class="co"># two-sided, exact</span>
<span class="co">## </span>
<span class="co">##  Exact one-sample Kolmogorov-Smirnov test</span>
<span class="co">## </span>
<span class="co">## data:  x + 2</span>
<span class="co">## D = 0.26631, p-value = 0.001277</span>
<span class="co">## alternative hypothesis: two-sided</span>
<span class="fu"><a href="https://rdrr.io/r/stats/ks.test.html">ks.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">+</span><span class="fl">2</span>, <span class="st">"pgamma"</span>, <span class="fl">3</span>, <span class="fl">2</span>, exact <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">##  Asymptotic one-sample Kolmogorov-Smirnov test</span>
<span class="co">## </span>
<span class="co">## data:  x + 2</span>
<span class="co">## D = 0.26631, p-value = 0.001663</span>
<span class="co">## alternative hypothesis: two-sided</span>
<span class="fu"><a href="https://rdrr.io/r/stats/ks.test.html">ks.test</a></span><span class="op">(</span><span class="va">x</span><span class="op">+</span><span class="fl">2</span>, <span class="st">"pgamma"</span>, <span class="fl">3</span>, <span class="fl">2</span>, alternative <span class="op">=</span> <span class="st">"gr"</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">##  Exact one-sample Kolmogorov-Smirnov test</span>
<span class="co">## </span>
<span class="co">## data:  x + 2</span>
<span class="co">## D^+ = 0.059654, p-value = 0.6742</span>
<span class="co">## alternative hypothesis: the CDF of x lies above the null hypothesis</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For an overview on distribution see here: http://www.stat.umn.edu/geyer/old/5101/rlook.html</p>
</section></section><section id="other-tests" class="level2" data-number="3.12"><h2 data-number="3.12" class="anchored" data-anchor-id="other-tests">
<span class="header-section-number">3.12</span> Other tests</h2>
<section id="correlation" class="level3" data-number="3.12.1"><h3 data-number="3.12.1" class="anchored" data-anchor-id="correlation">
<span class="header-section-number">3.12.1</span> Correlation</h3>
<p>A test for the significance of a correlation:</p>
<div class="cell">
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span><span class="op">(</span><span class="va">airquality</span><span class="op">$</span><span class="va">Ozone</span>, <span class="va">airquality</span><span class="op">$</span><span class="va">Wind</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">##  Pearson's product-moment correlation</span>
<span class="co">## </span>
<span class="co">## data:  airquality$Ozone and airquality$Wind</span>
<span class="co">## t = -8.0401, df = 114, p-value = 9.272e-13</span>
<span class="co">## alternative hypothesis: true correlation is not equal to 0</span>
<span class="co">## 95 percent confidence interval:</span>
<span class="co">##  -0.7063918 -0.4708713</span>
<span class="co">## sample estimates:</span>
<span class="co">##        cor </span>
<span class="co">## -0.6015465</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Interpretation: Ozone and Wind are significantly negatively correlated with a p-value &lt; 0.05 and a correlation coefficient of -0.6015465.</p>
</section><section id="mantel-test" class="level3" data-number="3.12.2"><h3 data-number="3.12.2" class="anchored" data-anchor-id="mantel-test">
<span class="header-section-number">3.12.2</span> Mantel test</h3>
<p>The Mantel test compares two distance matrices</p>
<div class="cell">
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/vegandevs/vegan">vegan</a></span><span class="op">)</span>
<span class="co">## Is vegetation related to environment?</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">varespec</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">varechem</span><span class="op">)</span>
<span class="va">veg.dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/vegdist.html">vegdist</a></span><span class="op">(</span><span class="va">varespec</span><span class="op">)</span> <span class="co"># Bray-Curtis</span>
<span class="va">env.dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/vegdist.html">vegdist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">varechem</span><span class="op">)</span>, <span class="st">"euclid"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/vegan/man/mantel.html">mantel</a></span><span class="op">(</span><span class="va">veg.dist</span>, <span class="va">env.dist</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">## Mantel statistic based on Pearson's product-moment correlation </span>
<span class="co">## </span>
<span class="co">## Call:</span>
<span class="co">## mantel(xdis = veg.dist, ydis = env.dist) </span>
<span class="co">## </span>
<span class="co">## Mantel statistic r: 0.3047 </span>
<span class="co">##       Significance: 0.001 </span>
<span class="co">## </span>
<span class="co">## Upper quantiles of permutations (null model):</span>
<span class="co">##   90%   95% 97.5%   99% </span>
<span class="co">## 0.109 0.136 0.165 0.198 </span>
<span class="co">## Permutation: free</span>
<span class="co">## Number of permutations: 999</span>
<span class="fu"><a href="https://rdrr.io/pkg/vegan/man/mantel.html">mantel</a></span><span class="op">(</span><span class="va">veg.dist</span>, <span class="va">env.dist</span>, method<span class="op">=</span><span class="st">"spear"</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">## Mantel statistic based on Spearman's rank correlation rho </span>
<span class="co">## </span>
<span class="co">## Call:</span>
<span class="co">## mantel(xdis = veg.dist, ydis = env.dist, method = "spear") </span>
<span class="co">## </span>
<span class="co">## Mantel statistic r: 0.2838 </span>
<span class="co">##       Significance: 0.001 </span>
<span class="co">## </span>
<span class="co">## Upper quantiles of permutations (null model):</span>
<span class="co">##   90%   95% 97.5%   99% </span>
<span class="co">## 0.118 0.149 0.174 0.199 </span>
<span class="co">## Permutation: free</span>
<span class="co">## Number of permutations: 999</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="exercises" class="level2" data-number="3.13"><h2 data-number="3.13" class="anchored" data-anchor-id="exercises">
<span class="header-section-number">3.13</span> Exercises</h2>
<section id="streams" class="level3" data-number="3.13.1"><h3 data-number="3.13.1" class="anchored" data-anchor-id="streams">
<span class="header-section-number">3.13.1</span> Streams</h3>
<p>The dataset ‘streams’ contains water measurements taken at different locations along 16 rivers: ‘up’ and ‘down’ are water quality measurements of the same river taken before and after a water treatment filter, respectively. We want to find out if this water filter is effective. Use the decision tree to identify the appropriate test for this situation.</p>
<div class="cell">
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">dat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="st">"https://raw.githubusercontent.com/biometry/APES/master/Data/Simone/streams.txt"</span>, header <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Visualize and analyze the data and answer the following questions at <strong>elearning-extern</strong>.</p>
<ol type="1">
<li>For identifying an appropriate test for the effect of the water treatment filter, what are your first two choices in the decision tree?</li>
<li>The next decision you have to make is whether you can use a parametric test or not. Apply the Shapiro-Wilk test to check if the data are normally distributed. Are the tests significant and what does that tell you?</li>
<li>Which test is appropriate for evaluating the effect of the filter?</li>
<li>Does the filter influence the water quality? (The warnings are related to identical values, i.e.&nbsp;ties, and zero differences; we ignore these here)</li>
</ol>
<div class="callout-tip callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>You can visualize the data as follows:</p>
<div class="cell">
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">dat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="st">"https://raw.githubusercontent.com/biometry/APES/master/Data/Simone/streams.txt"</span>, header <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html">matplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"l"</span><span class="op">)</span> <span class="co"># each line is one river, left is down and right is upstream</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="3-HypothesisTesting_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol type="1">
<li>The number of groups to compare is <strong>two</strong>, up versus down stream. The observations are <strong>paired</strong> because the water tested up and down stream of the filter is not independent from each other, i.e.&nbsp;the “same” water is measured twice!</li>
<li>The Shapiro-Wilk test is significant (p &lt; 0.05) for down stream data, i.e.&nbsp;we reject H0 (the data is normally distributed). Thus, the data significantly deviate from a normal distribution. The test is not significant for upstream data; the data does not significantly deviate from a normal distribution.</li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">down</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">##  Shapiro-Wilk normality test</span>
<span class="co">## </span>
<span class="co">## data:  dat$down</span>
<span class="co">## W = 0.86604, p-value = 0.02367</span>
<span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">up</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">##  Shapiro-Wilk normality test</span>
<span class="co">## </span>
<span class="co">## data:  dat$up</span>
<span class="co">## W = 0.93609, p-value = 0.3038</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="3" type="1">
<li>We select a <strong>Wilcoxon signed rank test</strong> that is appropriate to compare not-normal, paired observations in two groups.</li>
<li>H0 of the Wilcoxon signed rank test is that the location shift between the two groups equals zero, i.e.&nbsp;the difference between the pairs follows a symmetric distribution around zero. As p &lt; 0.05, we can reject H0. The filter significantly influences water quality. (In case of ties also see the function wilcox.test() in the package coin for exact, asymptotic and Monte Carlo conditional p-values)</li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/wilcox.test.html">wilcox.test</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">down</span>, <span class="va">dat</span><span class="op">$</span><span class="va">up</span>, paired <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>
<span class="co">## Warning in wilcox.test.default(dat$down, dat$up, paired = T): cannot compute</span>
<span class="co">## exact p-value with ties</span>
<span class="co">## Warning in wilcox.test.default(dat$down, dat$up, paired = T): cannot compute</span>
<span class="co">## exact p-value with zeroes</span>
<span class="co">## </span>
<span class="co">##  Wilcoxon signed rank test with continuity correction</span>
<span class="co">## </span>
<span class="co">## data:  dat$down and dat$up</span>
<span class="co">## V = 8, p-value = 0.004971</span>
<span class="co">## alternative hypothesis: true location shift is not equal to 0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section><section id="chicken" class="level3" data-number="3.13.2"><h3 data-number="3.13.2" class="anchored" data-anchor-id="chicken">
<span class="header-section-number">3.13.2</span> Chicken</h3>
<p>The ‘chickwts’ experiment was carried out to measure and compare the effectiveness of various feed supplements on the growth rate of chickens. We are interested in two questions: Does the feed type influence the chickens weight at all? Which feed types result in significantly different chicken weights?</p>
<div class="cell">
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">dat</span> <span class="op">=</span> <span class="va">chickwts</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Analyze the data and answer the following questions at <strong>elearning-extern</strong>.</p>
<ol type="1">
<li>Visualize the data. What is an appropriate plot for this kind of data?</li>
<li>Can you apply an ANOVA to this data? What are the assumptions for an ANOVA? Remember: you have to test two things for the groups (for this exercise it is enough if you test the groups “casein” and “horsebean” only).</li>
<li>Apply an ANOVA or the non-parametric test. How would you describe the result in a thesis or publication?</li>
<li>Also apply the alternative test and compare p-values. Which of the tests has a higher power?</li>
<li>Use the result of the ANOVA to carry out a post-hoc test. How many of the pairwise comparisons indicate significant differences between the groups?</li>
<li>Which conclusion about the feed types ‘meatmeal’ and ‘casein’ is correct?</li>
</ol>
<div class="callout-tip callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li>An appropriate visualization for one numeric and one categorial variable is a <strong>boxplot</strong>. Using ‘notch = T’ in the function boxplot(), adds confidence interval for the median (the warning here indicates that we are not very confident in the estimates of the medians as the number of observations is rather small, you can see at the notches that go beyond the boxes).</li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">dat</span> <span class="op">=</span> <span class="va">chickwts</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">weight</span> <span class="op">~</span> <span class="va">feed</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="3-HypothesisTesting_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html">boxplot</a></span><span class="op">(</span><span class="va">weight</span> <span class="op">~</span> <span class="va">feed</span>, data <span class="op">=</span> <span class="va">dat</span>, notch <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>
<span class="co">## Warning in (function (z, notch = FALSE, width = NULL, varwidth = FALSE, : some</span>
<span class="co">## notches went outside hinges ('box'): maybe set notch=FALSE</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="3-HypothesisTesting_files/figure-html/unnamed-chunk-46-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<ol start="2" type="1">
<li>The two requirements for applying an ANOVA are 1) the data in each group are normally distributed, and 2) the variances of the different groups are equal. For 1) we again use a Shapiro-Wilk test. For 2) we can use the function var.test() or for all feed types the function bartlett.test(). All tests are not significant, and we thus have no indication to assume that the data is not-normally distributed or that the variances are different. We can use an ANOVA.</li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># get data of each group</span>
<span class="va">casein</span> <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">weight</span><span class="op">[</span><span class="va">dat</span><span class="op">$</span><span class="va">feed</span> <span class="op">==</span> <span class="st">"casein"</span><span class="op">]</span>
<span class="va">horsebean</span> <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">weight</span><span class="op">[</span><span class="va">dat</span><span class="op">$</span><span class="va">feed</span> <span class="op">==</span> <span class="st">"horsebean"</span><span class="op">]</span>

<span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="va">casein</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">##  Shapiro-Wilk normality test</span>
<span class="co">## </span>
<span class="co">## data:  casein</span>
<span class="co">## W = 0.91663, p-value = 0.2592</span>
<span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="va">horsebean</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">##  Shapiro-Wilk normality test</span>
<span class="co">## </span>
<span class="co">## data:  horsebean</span>
<span class="co">## W = 0.93758, p-value = 0.5264</span>
<span class="co"># H0 normally distributed</span>
<span class="co"># not rejected, normality assumption is okay</span>

<span class="fu"><a href="https://rdrr.io/r/stats/var.test.html">var.test</a></span><span class="op">(</span><span class="va">casein</span>, <span class="va">horsebean</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">##  F test to compare two variances</span>
<span class="co">## </span>
<span class="co">## data:  casein and horsebean</span>
<span class="co">## F = 2.7827, num df = 11, denom df = 9, p-value = 0.1353</span>
<span class="co">## alternative hypothesis: true ratio of variances is not equal to 1</span>
<span class="co">## 95 percent confidence interval:</span>
<span class="co">##  0.711320 9.984178</span>
<span class="co">## sample estimates:</span>
<span class="co">## ratio of variances </span>
<span class="co">##           2.782737</span>
<span class="co"># H0 ratio of variances is 1 = groups have the same variance</span>
<span class="co"># not rejected, same variances is okay</span>


<span class="co">### Extra: testing the assumptions for all groups:</span>

<span class="co"># Normality test using the dplyr package</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="co">## </span>
<span class="co">## Attaching package: 'dplyr'</span>
<span class="co">## The following object is masked from 'package:MASS':</span>
<span class="co">## </span>
<span class="co">##     select</span>
<span class="co">## The following objects are masked from 'package:stats':</span>
<span class="co">## </span>
<span class="co">##     filter, lag</span>
<span class="co">## The following objects are masked from 'package:base':</span>
<span class="co">## </span>
<span class="co">##     intersect, setdiff, setequal, union</span>
<span class="va">dat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">feed</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="va">weight</span><span class="op">)</span><span class="op">$</span><span class="va">p</span><span class="op">)</span>
<span class="co">## # A tibble: 6 × 2</span>
<span class="co">##   feed          p</span>
<span class="co">##   &lt;fct&gt;     &lt;dbl&gt;</span>
<span class="co">## 1 casein    0.259</span>
<span class="co">## 2 horsebean 0.526</span>
<span class="co">## 3 linseed   0.903</span>
<span class="co">## 4 meatmeal  0.961</span>
<span class="co">## 5 soybean   0.506</span>
<span class="co">## 6 sunflower 0.360</span>

<span class="co"># Bartlett test for equal variances</span>
<span class="fu"><a href="https://rdrr.io/r/stats/bartlett.test.html">bartlett.test</a></span><span class="op">(</span><span class="va">weight</span> <span class="op">~</span> <span class="va">feed</span>, <span class="va">dat</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">##  Bartlett test of homogeneity of variances</span>
<span class="co">## </span>
<span class="co">## data:  weight by feed</span>
<span class="co">## Bartlett's K-squared = 3.2597, df = 5, p-value = 0.66</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="3" type="1">
<li>H0 of the ANOVA is that feed has no influence on the chicken weight. As p &lt; 0.05, we reject H0. In the result section, we would write something like: “The feed type significantly influenced the chicken weight (ANOVA, p = 5.94e-10).”</li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">fit</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">weight</span> <span class="op">~</span> <span class="va">feed</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span>
<span class="co">##             Df Sum Sq Mean Sq F value   Pr(&gt;F)    </span>
<span class="co">## feed         5 231129   46226   15.37 5.94e-10 ***</span>
<span class="co">## Residuals   65 195556    3009                     </span>
<span class="co">## ---</span>
<span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="4" type="1">
<li>The non-parametric alternative of an ANOVA is the Kruskal-Wallis test, which should be applied if the data is not normally distributed. In this example, the test comes to the same conclusion: H0 is rejected, the feed type has a significant effect on the chicken weight. The p-value, however, is not as small as in the ANOVA. The reason for this is that non-parametric tests have a lower power than parametric ones as they only use the ranks of the data. Therefore, the ANOVA is preferred over the non-parametric alternative in case its assumptions are fulfilled.</li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/kruskal.test.html">kruskal.test</a></span><span class="op">(</span><span class="va">chickwts</span><span class="op">$</span><span class="va">weight</span>, <span class="va">chickwts</span><span class="op">$</span><span class="va">feed</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">##  Kruskal-Wallis rank sum test</span>
<span class="co">## </span>
<span class="co">## data:  chickwts$weight and chickwts$feed</span>
<span class="co">## Kruskal-Wallis chi-squared = 37.343, df = 5, p-value = 5.113e-07</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="5" type="1">
<li>From the 15 comparisons among feed types, 8 are significantly different.</li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/TukeyHSD.html">TukeyHSD</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span>
<span class="co">##   Tukey multiple comparisons of means</span>
<span class="co">##     95% family-wise confidence level</span>
<span class="co">## </span>
<span class="co">## Fit: aov(formula = weight ~ feed, data = dat)</span>
<span class="co">## </span>
<span class="co">## $feed</span>
<span class="co">##                            diff         lwr       upr     p adj</span>
<span class="co">## horsebean-casein    -163.383333 -232.346876 -94.41979 0.0000000</span>
<span class="co">## linseed-casein      -104.833333 -170.587491 -39.07918 0.0002100</span>
<span class="co">## meatmeal-casein      -46.674242 -113.906207  20.55772 0.3324584</span>
<span class="co">## soybean-casein       -77.154762 -140.517054 -13.79247 0.0083653</span>
<span class="co">## sunflower-casein       5.333333  -60.420825  71.08749 0.9998902</span>
<span class="co">## linseed-horsebean     58.550000  -10.413543 127.51354 0.1413329</span>
<span class="co">## meatmeal-horsebean   116.709091   46.335105 187.08308 0.0001062</span>
<span class="co">## soybean-horsebean     86.228571   19.541684 152.91546 0.0042167</span>
<span class="co">## sunflower-horsebean  168.716667   99.753124 237.68021 0.0000000</span>
<span class="co">## meatmeal-linseed      58.159091   -9.072873 125.39106 0.1276965</span>
<span class="co">## soybean-linseed       27.678571  -35.683721  91.04086 0.7932853</span>
<span class="co">## sunflower-linseed    110.166667   44.412509 175.92082 0.0000884</span>
<span class="co">## soybean-meatmeal     -30.480519  -95.375109  34.41407 0.7391356</span>
<span class="co">## sunflower-meatmeal    52.007576  -15.224388 119.23954 0.2206962</span>
<span class="co">## sunflower-soybean     82.488095   19.125803 145.85039 0.0038845</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="6" type="1">
<li>The experiment did not reveal a significant weight difference between the feed types ‘meatmeal’ and ‘casein’. Remember that we cannot prove or accept H0; we can only reject it.</li>
</ol>
</div>
</div>
</div>
</section><section id="titanic" class="level3" data-number="3.13.3"><h3 data-number="3.13.3" class="anchored" data-anchor-id="titanic">
<span class="header-section-number">3.13.3</span> Titanic</h3>
<p>The dataset ‘titanic’ from the EcoData package (not to confuse with the dataset ‘Titanic’) provides information on individual passengers of the Titanic.</p>
<div class="cell">
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/TheoreticalEcology/">EcoData</a></span><span class="op">)</span> <span class="co">#or: load("EcoData.Rdata"), if you had problems with installing the package</span>
<span class="va">dat</span> <span class="op">=</span> <span class="va">titanic</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Answer the following questions at <strong>elearning-extern</strong>.</p>
<ol type="1">
<li>We are interested in first and second class differences only. Reduce the dataset to these classes only. How can you do this in R?</li>
<li>Does the survival rate between the first and second class differ? Hint: you can apply the test to a contigency table of passenger class versus survived, i.e.&nbsp;<code>table(dat$pclass, dat$survived)</code>.</li>
<li>Is the variable passenger age normally distributed?</li>
<li>Is the variable Body Identification Number (body) uniformly distributed?</li>
<li>Is the correlation between fare and age significant?</li>
</ol>
<div class="callout-tip callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li>The dataset can be reduced in different ways. All three options result in a dataset with class 1 and 2 only.</li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/TheoreticalEcology/">EcoData</a></span><span class="op">)</span>
<span class="va">dat</span> <span class="op">=</span> <span class="va">titanic</span>

<span class="va">dat</span> <span class="op">=</span> <span class="va">dat</span><span class="op">[</span><span class="va">dat</span><span class="op">$</span><span class="va">pclass</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">|</span> <span class="va">dat</span><span class="op">$</span><span class="va">pclass</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span>
<span class="va">dat</span> <span class="op">=</span> <span class="va">dat</span><span class="op">[</span><span class="va">dat</span><span class="op">$</span><span class="va">pclass</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="op">]</span> <span class="co"># the same</span>
<span class="va">dat</span> <span class="op">=</span> <span class="va">dat</span><span class="op">[</span><span class="va">dat</span><span class="op">$</span><span class="va">pclass</span> <span class="op">!=</span> <span class="fl">3</span>, <span class="op">]</span> <span class="co"># the same</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="1">
<li>We use the test of equal proportions here. H0, proportions in the two groups are equal, is rejected. The survival probability in class 1 and class 2 is significantly different. Note that the estimated proportions are for mortality not for survival because 0=died is in the first column of the table. Thus it is considered the “success” in the prop.test().</li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">pclass</span>, <span class="va">dat</span><span class="op">$</span><span class="va">survived</span><span class="op">)</span>
<span class="co">##    </span>
<span class="co">##       0   1</span>
<span class="co">##   1 123 200</span>
<span class="co">##   2 158 119</span>
<span class="fu"><a href="https://rdrr.io/r/stats/prop.test.html">prop.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">pclass</span>, <span class="va">dat</span><span class="op">$</span><span class="va">survived</span><span class="op">)</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">##  2-sample test for equality of proportions with continuity correction</span>
<span class="co">## </span>
<span class="co">## data:  table(dat$pclass, dat$survived)</span>
<span class="co">## X-squared = 20.772, df = 1, p-value = 5.173e-06</span>
<span class="co">## alternative hypothesis: two.sided</span>
<span class="co">## 95 percent confidence interval:</span>
<span class="co">##  -0.2717017 -0.1074826</span>
<span class="co">## sample estimates:</span>
<span class="co">##    prop 1    prop 2 </span>
<span class="co">## 0.3808050 0.5703971</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="3" type="1">
<li>The distribution of passenger age significantly differs from normal.</li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">age</span>, breaks <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="3-HypothesisTesting_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">age</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">##  Shapiro-Wilk normality test</span>
<span class="co">## </span>
<span class="co">## data:  dat$age</span>
<span class="co">## W = 0.9876, p-value = 0.00014</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="4" type="1">
<li>The distribution of body significantly differs from uniform.</li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">body</span>, breaks <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="3-HypothesisTesting_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/ks.test.html">ks.test</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">body</span>, <span class="st">"punif"</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">##  Exact one-sample Kolmogorov-Smirnov test</span>
<span class="co">## </span>
<span class="co">## data:  dat$body</span>
<span class="co">## D = 1, p-value = 2.22e-16</span>
<span class="co">## alternative hypothesis: two-sided</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="5" type="1">
<li>The correlation between fare and age is non-significant. You can also plot the data using the scatter.smooth function.</li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/cor.test.html">cor.test</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">fare</span>, <span class="va">dat</span><span class="op">$</span><span class="va">age</span><span class="op">)</span>
<span class="co">## </span>
<span class="co">##  Pearson's product-moment correlation</span>
<span class="co">## </span>
<span class="co">## data:  dat$fare and dat$age</span>
<span class="co">## t = 1.9326, df = 543, p-value = 0.0538</span>
<span class="co">## alternative hypothesis: true correlation is not equal to 0</span>
<span class="co">## 95 percent confidence interval:</span>
<span class="co">##  -0.001346105  0.165493055</span>
<span class="co">## sample estimates:</span>
<span class="co">##        cor </span>
<span class="co">## 0.08265257</span>
<span class="fu"><a href="https://rdrr.io/r/stats/scatter.smooth.html">scatter.smooth</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">fare</span>, <span class="va">dat</span><span class="op">$</span><span class="va">age</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="3-HypothesisTesting_files/figure-html/unnamed-chunk-56-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
</section><section id="simulation-of-type-i-and-ii-error" class="level3" data-number="3.13.4"><h3 data-number="3.13.4" class="anchored" data-anchor-id="simulation-of-type-i-and-ii-error">
<span class="header-section-number">3.13.4</span> Simulation of Type I and II error</h3>
<p><em>This is an additional task for those who are fast! Please finish the other parts first and submit your solution in elearning-extern before you continue here!</em></p>
<p>Analogously to the previous example of simulating the test statistic, we can also simulate error rates. Complete the code …</p>
<div class="cell">
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">PperGroup</span> <span class="op">=</span> <span class="fl">50</span>
<span class="va">pC</span> <span class="op">=</span> <span class="fl">0.5</span>
<span class="va">pT</span> <span class="op">=</span> <span class="fl">0.5</span>

<span class="va">pvalues</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">1000</span><span class="op">)</span>

<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">1000</span><span class="op">)</span><span class="op">{</span>
  <span class="va">control</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="va">PperGroup</span>, prob <span class="op">=</span> <span class="va">pC</span><span class="op">)</span>
  <span class="va">treat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="va">PperGroup</span>, prob <span class="op">=</span> <span class="va">pT</span><span class="op">)</span>
  <span class="co">#XXXX</span>
<span class="op">}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>… and answer the following questions for the prop.test in R:</p>
<ol type="1">
<li><p>How does the distribution of p-values and the number of false positive (Type I error) look like if pC = pT</p></li>
<li><p>How does the distribution of p-values and the number of true positive (Power) look like if pC != pT, e.g.&nbsp;0.5, 0.6</p></li>
<li><p>How does the distribution of p-values and the number of false positive (Type I error) look like if you modify the for loop in a way that you first look at the data, and then decide if you test for greater or less?</p></li>
</ol>
<div class="callout-tip callout callout-style-simple no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Analogously to our previous example with simulating the test statistic, we can also simulate the error rates. This is the completed code the different examples:</p>
<ol type="1">
<li>pC = pT</li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">PperGroup</span> <span class="op">=</span> <span class="fl">50</span>
<span class="va">pC</span> <span class="op">=</span> <span class="fl">0.5</span>
<span class="va">pT</span> <span class="op">=</span> <span class="fl">0.5</span>

<span class="va">pvalues</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">1000</span><span class="op">)</span>
<span class="va">positives</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">1000</span><span class="op">)</span>

<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">1000</span><span class="op">)</span><span class="op">{</span>
  <span class="va">control</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">PperGroup</span>, prob <span class="op">=</span> <span class="va">pC</span> <span class="op">)</span>
  <span class="va">treatment</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">PperGroup</span>, prob <span class="op">=</span> <span class="va">pT</span> <span class="op">)</span>
  <span class="va">pvalues</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/prop.test.html">prop.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">control</span>, <span class="va">treatment</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">PperGroup</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span>
  <span class="va">positives</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">pvalues</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;=</span> <span class="fl">0.05</span>
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">pvalues</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="3-HypothesisTesting_files/figure-html/unnamed-chunk-58-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">positives</span><span class="op">)</span>
<span class="co">## positives</span>
<span class="co">## FALSE  TRUE </span>
<span class="co">##   952    48</span>
<span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">positives</span><span class="op">)</span> 
<span class="co">## [1] 0.048</span>

<span class="co"># type I error rate = false positives (if data simulation etc. is performed several times, this should be on average 0.05 (alpha))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="1">
<li>pC != pT with difference 0.1</li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">PperGroup</span> <span class="op">=</span> <span class="fl">50</span>
<span class="va">pC</span> <span class="op">=</span> <span class="fl">0.5</span>
<span class="va">pT</span> <span class="op">=</span> <span class="fl">0.6</span>

<span class="va">pvalues</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">1000</span><span class="op">)</span>
<span class="va">positives</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">1000</span><span class="op">)</span>

<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">1000</span><span class="op">)</span><span class="op">{</span>
  <span class="va">control</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">PperGroup</span>, prob <span class="op">=</span> <span class="va">pC</span> <span class="op">)</span>
  <span class="va">treatment</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">PperGroup</span>, prob <span class="op">=</span> <span class="va">pT</span> <span class="op">)</span>
  <span class="va">pvalues</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/prop.test.html">prop.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">control</span>, <span class="va">treatment</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">PperGroup</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span>
  <span class="va">positives</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/prop.test.html">prop.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">control</span>, <span class="va">treatment</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">PperGroup</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span> <span class="op">&lt;</span> <span class="fl">0.05</span>
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">pvalues</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="3-HypothesisTesting_files/figure-html/unnamed-chunk-59-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">positives</span><span class="op">)</span>
<span class="co">## positives</span>
<span class="co">## FALSE  TRUE </span>
<span class="co">##   857   143</span>
<span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">pvalues</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span> <span class="co"># = power (rate at which effect is detected by the test)</span>
<span class="co">## [1] 0.143</span>
<span class="co"># power = 1- beta &gt; beta = 1-power = typeII error rate</span>
<span class="fl">1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">pvalues</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span>
<span class="co">## [1] 0.857</span>

<span class="co">## Factors increasing power and reducing type II errors:</span>
<span class="co"># - increase sample size</span>
<span class="co"># - larger real effect size (but this is usually fixed by the system)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="3" type="1">
<li>You first look at the data, and then decide if you test for greater or less:</li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># ifelse(test,yes,no)</span>
<span class="va">PperGroup</span> <span class="op">=</span> <span class="fl">50</span>
<span class="va">pC</span> <span class="op">=</span> <span class="fl">0.5</span>
<span class="va">pT</span> <span class="op">=</span> <span class="fl">0.5</span>

<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">1000</span><span class="op">)</span><span class="op">{</span>
  <span class="va">control</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">PperGroup</span>, prob <span class="op">=</span> <span class="va">pC</span> <span class="op">)</span>
  <span class="va">treatment</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">PperGroup</span>, prob <span class="op">=</span> <span class="va">pT</span> <span class="op">)</span>
  <span class="va">pvalues</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/prop.test.html">prop.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">control</span>, <span class="va">treatment</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">PperGroup</span>, <span class="fl">2</span><span class="op">)</span>, 
                        alternative<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">control</span><span class="op">)</span><span class="op">&gt;</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">treatment</span><span class="op">)</span>,
                                            <span class="st">"greater"</span>,<span class="st">"less"</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span>
  <span class="va">positives</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/prop.test.html">prop.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">control</span>, <span class="va">treatment</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">PperGroup</span>, <span class="fl">2</span><span class="op">)</span>,
                     alternative<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">control</span><span class="op">)</span><span class="op">&gt;</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">treatment</span><span class="op">)</span>,
                                         <span class="st">"greater"</span>,<span class="st">"less"</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span> <span class="op">&lt;</span> <span class="fl">0.05</span>
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">pvalues</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="3-HypothesisTesting_files/figure-html/unnamed-chunk-60-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">positives</span><span class="op">)</span>
<span class="co">## positives</span>
<span class="co">## FALSE  TRUE </span>
<span class="co">##   953    47</span>
<span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">pvalues</span> <span class="op">&lt;</span> <span class="fl">0.05</span><span class="op">)</span> 
<span class="co">## [1] 0.047</span>
<span class="co"># higher false discovery rate</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>


</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./2-DescriptiveStatistics.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Plotting and describing data</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./4-SimpleRegression.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Simple linear regression</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>